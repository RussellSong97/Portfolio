<!DOCTYPE html>
<!--suppress HtmlFormInputWithoutLabel, HtmlFormInputWithoutLabel, Annotator -->
<html lang="ko"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout_product}">
<head>
    <!-- Kakao SDK 추가 -->
    <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
    <script id="happytalkSDK" src="https://design.happytalkio.com/sdk/happytalk.chat.v2.min.js"></script>
    <title>카통령 차량 상세보기</title>
</head>

<th:block layout:fragment="content">
    <div class="view-wrap">
        <div class="w-set">
            <div class="cont">
                <div class="vehicle-img">
                    <div class="sliderMain">
                        <div class="swiper-container">
                            <div class="swiper-navi">
                                <button class="swiper-button swiper-prev" type="button">이전</button>
                                <button class="swiper-button swiper-next" type="button">다음</button>
                            </div>
                            <div class="swiper-wrapper">
                                <div class="swiper-slide" th:each="image : ${productDetail.carImageUrl}">
                                    <div class="img">
                                        <img th:src="${image.realUrl}" alt="이미지">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="sliderPaging">
                        <div class="swiper-navi">
                            <button class="swiper-button swiper-prev" type="button">이전</button>
                            <button class="swiper-button swiper-next" type="button">다음</button>
                        </div>
                        <div class="swiper-container">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide" th:each="image : ${productDetail.carImageUrl}">
                                    <div class="img">
                                        <img th:src="${image.realUrl + '?size=1500'}" alt="이미지">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="cont">
                <div class="vehicle-info">
                    <div class="info-top">
                        <span class="views"
                              th:text="${#numbers.formatInteger(productDetail.hits, 1, 'COMMA')}">165</span>

                        <label class="btn-like">
                            <input type="checkbox"
                                   th:attr="productId=${productDetail.productId}"
                                   th:checked="${productDetail.picked}"
                                   class="pick_check">
                            <span class="like-visual">좋아요</span>
                            <!--픽 카운트 -->
                            <span class="count" id="viewPickCount" th:text="${productDetail.pickCount}">2</span>
                        </label>

                        <button type="button" class="btn-share" onclick="$popup.template('#sharePopup')">공유하기
                        </button>
                    </div>
                    <p class="tit" th:text="${'(' + productDetail.carPlateNumber + ')' +
                            productDetail.makerName + ' ' + productDetail.modelName + ' ' +
                            productDetail.detailGradeName}">(140하4761) 기아 카니발 4세대 G3.5 GDI 9인승 시그니처 길면 두줄</p>
                    <div class="d-info">
                        <div class="info-row">
                            <span class="txt" th:text="${productDetail.carRegYear}">22년 04월 (23년형)</span>
                            <span class="txt"
                                  th:text="${#numbers.formatInteger(productDetail.carUseKm, 1, 'COMMA') + ' km'}">98,408km</span>
                            <span class="txt" th:text="${productDetail.carFuel}">가솔린</span>
                            <span class="txt" th:text="${productDetail.city}">인천</span>
                        </div>
                        <!-- Thymeleaf 템플릿 예제 -->
                        <p class="price"><strong>[[${productDetail.getFormattedCarAmountSale()}]]</strong>만원</p>
                    </div>
                    <ul class="popup-list">
                        <li class="is-year">
                            <button type="button" class="btn-popup" onclick="$popup.template('#mileagePopup')">
                                <i class="i-year">
                                    <strong th:text="${yearDifference}">2</strong>년
                                </i>
                                <span class="txt"
                                      th:text="${#numbers.formatInteger(productDetail.carUseKm, 1, 'COMMA') + ' km'}">98,408km</span>
                            </button>
                        </li>
                        <li>
                            <button id="inspectionButton" class="btn-popup">
                                <i class="i-inspection"></i>
                                <span class="txt">성능점검<br>기록부</span>
                            </button>
                        </li>
                        <!--                        <li class="is-logout">-->
                        <!--                            <a href="javascript:void(0);" class="btn-popup" onclick="">-->
                        <!--                                <i class="i-insurance"></i>-->
                        <!--                                <span class="txt">보험료<br class="hide-pc"> 조회</span>-->
                        <!--                            </a>-->
                        <!--                        </li>-->
                        <li>
                            <button type="button" class="btn-popup"
                                    onclick="$popup.template('#totalCostPopup')">
                                <i class="i-purchase"></i>
                                <span class="txt">총 구매 비용<br>조회</span>
                            </button>
                        </li>
                        <li>
                            <button type="button" class="btn-popup"
                                    onclick="$popup.template('#calculatorPopup')">
                                <i class="i-calculator"></i>
                                <span class="txt">할부/리스<br>계산기</span>
                            </button>
                        </li>
                    </ul>
                    <div class="reservation-area">
                        <p class="txt">과 편리하게 상담하세요!</p>
                        <th:block sec:authorize="isAnonymous()">
                            <button type="button" class="btn" onclick="$popup.template('#memberSelectPopup')">방문
                                예약
                            </button>
                        </th:block>
                        <th:block sec:authorize="!isAnonymous()">
                            <button type="button" class="btn"
                                    onclick="$popup.template('#reservationInputPopup')">방문 예약
                            </button>
                        </th:block>
                    </div>
                </div>
            </div>
            <div class="cont">
                <div class="tit-area">
                    <span class="tit">기본정보</span>
                    <button type="button" class="btn color3" onclick="$popup.template('#detailPopup')">상세 정보
                    </button>
                </div>
                <div class="info-wrap">
                    <dl>
                        <dt>차량번호</dt>
                        <dd th:text="${productDetail.carPlateNumber}">01나3391</dd>
                    </dl>
                    <dl>
                        <dt>제조사</dt>
                        <dd th:text="${productDetail.makerName}">현대</dd>
                    </dl>
                    <dl>
                        <dt>모델</dt>
                        <dd th:text="${productDetail.modelName}">EQ900</dd>
                    </dl>
                    <dl>
                        <dt>세부 모델</dt>
                        <dd th:text="${productDetail.detailModelName}">EQ900</dd>
                    </dl>
                    <dl>
                        <dt>등급</dt>
                        <dd th:text="${productDetail.detailGradeName}">3.3 T-GDI</dd>
                    </dl>
                    <dl>
                        <dt>세부 등급</dt>
                        <dd th:text="${productDetail.detailGradeName}">프레스티지</dd>
                    </dl>
                    <dl>
                        <dt>미션</dt>
                        <dd th:text="${productDetail.carMission}">오토</dd>
                    </dl>
                    <dl>
                        <dt>연료</dt>
                        <dd th:text="${productDetail.carFuel}">휘발유</dd>
                    </dl>
                    <dl>
                        <dt>색상</dt>
                        <dd th:text="${productDetail.carColor}">검정색</dd>
                    </dl>
                    <dl>
                        <dt>연식</dt>
                        <dd th:text="${productDetail.carRegYear + '년'}">2023년 1월</dd>
                    </dl>
                    <dl>
                        <dt>주행거리</dt>
                        <dd th:text="${#numbers.formatInteger(productDetail.carUseKm, 1, 'COMMA') + ' km'}">
                            25,120km
                        </dd>
                    </dl>
                    <dl>
                        <dt>등록일</dt>
                        <dd id="date-display" th:attr="data-date=${productDetail.frstRegistDe}">2024-01-01</dd>

                    </dl>
                    <dl class="type-full">
                        <dt>비고</dt>
                        <dd th:text="${productDetail.carContent}">사고 차량입니다. 1인 소유로 관리 잘 된 차량입니다.</dd>
                    </dl>
                </div>
            </div>
            <div class="cont">
                <div class="tit-area">
                    <span class="tit">옵션 정보</span>
                    <!--                    <button type="button" class="btn color3" onclick="$popup.template('#optionPopup')">옵션 전체보기-->
                    <button type="button" class="btn color3" onclick="$popup.template('#optionPopup')">옵션 전체보기

                    </button>
                </div>
                <div class="option-wrap hide-m">
                    <ul class="option-list">
                        <li class="optionIcon" data-optionName="스마트 키">
                            <i class="i-option1"></i>
                            <p class="txt">스마트 키</p>
                        </li>
                        <li class="optionIcon" data-optionName="열선시트">
                            <i class="i-option2"></i>
                            <p class="txt">열선시트</p>
                        </li>
                        <li class="optionIcon" data-optionName="통풍시트">
                            <i class="i-option3"></i>
                            <p class="txt">통풍시트</p>
                        </li>
                        <li class="optionIcon" data-optionName="선루프">
                            <i class="i-option4"></i>
                            <p class="txt">선루프</p>
                        </li>
                        <li class="optionIcon" data-optionName="내비게이션">
                            <i class="i-option5"></i>
                            <p class="txt">내비게이션</p>
                        </li>
                        <li class="optionIcon" data-optionName="후방카메라">
                            <i class="i-option6"></i>
                            <p class="txt">후방카메라</p>
                        </li>
                        <li class="optionIcon" data-optionName="크루즈 컨트롤">
                            <i class="i-option7"></i>
                            <p class="txt">크루즈 컨트롤</p>
                        </li>
                        <li class="optionIcon" data-optionName="블루투스">
                            <i class="i-option8"></i>
                            <p class="txt">블루투스</p>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="cont">
                <div class="tit-area">
                    <span class="tit">제원 정보</span>
                    <button type="button" class="btn color3"
                            th:attr="data-detailGradeNumber=${productDetail.productDetailGradeNumber}"
                            onclick="specPopup(this)">제원
                        전체보기
                    </button>
                </div>
                <div class="specification-wrap hide-m">
                    <!--                    <img th:src="${productDetail.specImageId == null ? '' : productDetail.specImageId}" alt="제원 정보">-->
                    <img src="/user/images/common/img/view_specification.png" alt="제원 정보">
                </div>
            </div>
            <div class="cont">
                <a href="javascript:;" class="tit-area" id="searchCarHistoryMobile">
                    <span class="tit">보험 사고 이력조회</span>
                    <span class="btn color3 hide-pc">보험 사고 이력조회 보기</span>
                </a>
                <div class="insurance-wrap hide-m">
                    <div class="txt-area">
                        <strong class="tit">보험 사고 이력 조회</strong>
                        <p class="txt">로그인 후에 사용하실 수 있으며, 하루에 5대 이상은<br> 조회 하실 수 없습니다.</p>
                        <button type="button" class="btn" id="searchCarHistory">조회하기</button>
                    </div>
                </div>
            </div>
            <!--            <div class="cont">-->
            <!--                <div class="tit-area">-->
            <!--                    <span class="tit">제조사 A/S 잔여 기간</span>-->
            <!--                </div>-->
            <!--                <div class="as-wrap">-->
            <!--                    <div class="as-progress">-->
            <!--                        <div class="pw-bar">-->
            <!--                            <div class="pw-bar-inner" style="width: 20%" id="asPercentWidth">-->
            <!--                                <span class="txt" id="asPercentText">3개월</span>-->
            <!--                            </div>-->
            <!--                        </div>-->
            <!--                    </div>-->
            <!--                    <div class="info-txt">제조사가 고지하고 있는 A/S 조건 정보를 기준으로 잔여 기간을 계산하여 표시되는 정보입니다. 실제 조건과 상이할 수 있으므로-->
            <!--                        보다 정확한 정보는 제조사 홈페이지를 참고해 주시기 바랍니다.-->
            <!--                    </div>-->
            <!--                </div>-->
            <!--            </div>-->
            <div class="cont">
                <div class="tit-area">
                    <span class="tit">딜러 정보</span>
                </div>
                <div class="dealer-wrap">
                    <div class="info-top">
                        <div class="profile">
                            <img th:if="${productDetail.profileImageJson != null && productDetail.profileImageJson.uuid != null}"
                                 th:src="@{/api/file/view/__${productDetail.profileImageJson.uuid}__?size=500}"
                                 alt="프로필 사진">
                            <img th:if="${productDetail.profileImageJson == null || productDetail.profileImageJson.uuid == null}"
                                 src="/user/images/dummy/profile01.jpg"
                                 alt="기본 프로필 사진">
                        </div>
                        <div class="info-txt">
                            <p class="name"><strong>[[${productDetail.dealerName}]]</strong>딜러</p>
                            <p class="call" th:text="${productDetail.getFormattedMobileNumber}">
                                051-0000-0000</p>
                        </div>
                        <p class="introduce" th:text="${productDetail.intro}">전문성을 갖춘 준비된 카 매니저, 차별화된 전략으로 최상의
                            중고차를 찾아드리겠습니다.</p>
                    </div>
                    <div class="info-detail">
                        <dl>
                            <dt>상사 주소</dt>
                            <dd>경기 수원시 권선구 평동로 79번길 45 SK Motors 216, 217호 (주)CTRM</dd>
                        </dl>
                        <dl>
                            <dt>사원증 번호</dt>
                            <dd th:text="${productDetail.employeeNumber}">GC94775526</dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>
        <div class="cont type-bg">
            <div class="w-set">
                <div class="tit-area">
                    <span class="tit">선착순 특가 차량</span>
                </div>
                <div class="sale-wrap">
                    <div class="swiper-wrap sale-slide">
                        <div class="swiper-navi">
                            <button type="button" class="swiper-button prev">이전</button>
                            <button type="button" class="swiper-button next">다음</button>
                        </div>
                        <div class="swiper">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide" th:each="recommend : ${recommendList}">
                                    <!-- 선착순 특가 badge -->
                                    <div class="prd-box"
                                         th:classappend="${recommend.shopName.contains('디에스 오토')} ? ' badge' : ''">
                                        <div class="prd-thumb">

                                            <label class="btn-like">
                                                <input type="checkbox"
                                                       th:attr="productId=${recommend.productId}"
                                                       th:checked="${recommend.picked}"
                                                       class="pick_check">
                                                <span class="like-visual">좋아요</span>
                                            </label>

                                            <a th:href="@{/product/__${recommend.productId}__}">
                                                <img th:src="${recommend.carImageUrl}" alt="이미지">
                                            </a>
                                        </div>
                                        <a href="javascript:;" class="prd-info">
                                            <p class="prd-name"
                                               th:text="${recommend.makerName + ' ' + recommend.modelName}">KIA
                                                더 뉴 쏘렌토</p>
                                            <p class="price-info">
                                                <span class="num-price"
                                                      th:text="${recommend.getFormattedCarAmountSale()}">13,700만원</span>
                                            </p>
                                            <p class="detail-info">
                                                <span th:text="${recommend.carRegYear}">2019/04(2019)</span>
                                                <span th:text="${#numbers.formatInteger(recommend.carUseKm, 1, 'COMMA') + ' km'}">11,179 km</span>
                                                <span th:text="${recommend.city}">서울</span>
                                            </p>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--차량 상세 끝 -->

    <!-- 공유하기 팝업 -->
    <div class="wbz-popup-cont is-template" id="sharePopup">
        <div class="popup-header">
            <strong class="popup-title">공유하기</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <ul class="sns-list">
                <li>
                    <a href="#" onclick="kakaoClip()">
                        <i class="i-kakao"></i>
                        <span class="txt">카카오</span>
                    </a>
                </li>
                <li>
                    <a href="#" onclick="facebookClip()">
                        <i class="i-facebook"></i>
                        <span class="txt">페이스북</span>
                    </a>
                </li>
                <li>
                    <a href="#" onclick="urlClip()">
                        <i class="i-url"></i>
                        <span class="txt">URL 복사</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <!-- //공유하기 팝업 -->

    <!-- 주행거리 팝업 -->
    <!-- 2022 기준 연간 차량 한대 주행거리: 13322km -->
    <div class="wbz-popup-cont is-template" id="mileagePopup">
        <div class="popup-header">
            <strong class="popup-title">주행거리</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="mileage-wrap">
                <!-- 매우짧음:10, 짧음:30, 보통:50, 많음:70, 매우많음:90 -->
                <div class="mileage-cont" data-percentage="" id="percentId">
                    <!-- 매우짧음:mileage1, 짧음:mileage2, 보통:mileage3, 많음:mileage4, 매우많음:mileage5 -->
                    <div class="mileage mileage" id="mileageGauge">
                        <div class="inner"></div>
                    </div>
                    <div class="pointer"></div>
                    <div class="pointer-knob"></div>
                </div>
                <div class="total-txt">
                    <span class="total-period" th:text="${'총 ' + yearDifference + '년 간'}">총 6년 4개월간</span>
                    <p class="total-mileage"><strong class="c-primary"
                                                     th:text="${#numbers.formatInteger(productDetail.carUseKm, 1, 'COMMA') + ' km'}">127,966KM
                        주행</strong>/ 연평균 <span id="kmPerYear">20,000km </span> 주행</p>
                </div>
                <div class="result-txt">
                    <p class="txt">[[${productDetail.carPlateNumber}]] 차량의<br>주행거리는 일반적인 자동차 연평균 주행거리 대비 <span
                            id="statusText"> 매우 짧음 </span> 입니다</p>
                    <p class="standard">2022 한국도로교통공단 연평균 주행거리 발표 기준 <span id="krKmPerYear"> 13,322 </span>km</p>
                </div>
            </div>
        </div>
    </div>
    <!-- 주행거리 팝업 -->

    <!-- 성능점검기록부 팝업 -->
    <div class="wbz-popup-cont is-template" id="inspectionPopup">
        <div class="popup-header">
            <strong class="popup-title">성능점검기록부</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="inspection-wrap">

            </div>
        </div>
    </div>
    <!-- //성능점검기록부 팝업 -->

    <!-- 총 구매비용 조회 팝업 -->
    <div class="wbz-popup-cont is-template m-full" id="totalCostPopup">
        <div class="popup-header">
            <strong class="popup-title">총 구매비용 조회</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="cost-wrap">
                <p class="info">총 구매 비용에 대해 미리 확인해보실 수 있습니다. 실제 비용은 계산 결과와 일치하지 않을 수 있으니 대략적인 확인 용도로만 사용해주시기 바랍니다. 총 구매
                    비용에 보험료는 포함되지 않습니다.</p>

                <form method="post">
                    <div class="tablearea">
                        <table>
                            <tbody>
                            <tr>
                                <th scope="row">차량판매가격</th>
                                <td>
                                    <!-- default 값으로 parent의 차량가격을 가져옵니다. -->
                                    <div class="input-wrap">
                                        <input type="text" class="text" title="차량가격" id="salePrice" name="price"
                                               th:value="${productDetail.getFormattedCarAmountSale()}"
                                               disabled/>
                                    </div>
                                    <span class="unit">만원</span>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">용도 구분</th>
                                <td>
                                    <div class="radio-group">
                                        <input type="radio" id="option-one" name="purpose" value="category1"
                                               checked="checked"><label for="option-one">비영업용</label>
                                        <input type="radio" id="option-two" name="purpose" value="category2"><label
                                            for="option-two">영업용</label>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">차종 선택</th>
                                <td>
                                    <span class="selectbox">
                                        <select id="category1" name="type1">
                                            <option value="" selected>선택하세요</option>
                                            <option value="999">경차</option>
                                            <option value="1499">승용 1500cc 미만</option>
                                            <option value="1599">승용 1600cc 미만</option>
                                            <option value="1999">승용 1999cc 미만</option>
                                            <option value="2000">승용 2000cc 이상</option>
                                            <option value="7">승합 7~10인승</option>
                                            <option value="11">승합 11~15인승</option>
                                            <option value="16">승합 16~25인승</option>
                                            <option value="26">승합 26인승 이상</option>
                                            <option value="0.5">화물 0.6톤 미만</option>
                                            <option value="0.6">화물 0.6톤 이상</option>
                                            <option value="2.4">화물 2.5톤 미만</option>
                                            <option value="4.5">화물 4.6톤 미만</option>
                                            <option value="4.6">화물 4.6톤 이상</option>
                                        </select>
                                        <select id="category2" name="type2" style="display:none">
                                            <option value="" selected>선택하세요</option>
                                            <option value="999">경차</option>
                                            <option value="1000">승용 1000cc 이상</option>
                                            <option value="SUV">SUV</option>
                                            <option value="7">승합 7~10인승</option>
                                            <option value="11">승합 11~15인승</option>
                                            <option value="16">승합 16~25인승</option>
                                            <option value="26">승합 26인승 이상</option>
                                            <option value="0.5">화물 0.6톤 미만</option>
                                            <option value="0.6">화물 0.6톤 이상</option>
                                            <option value="2.4">화물 2.5톤 미만</option>
                                            <option value="4.5">화물 4.6톤 미만</option>
                                            <option value="4.6">화물 4.6톤 이상</option>
                                        </select>
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <th scope="row">지역 선택</th>
                                <td>
                                    <span class="selectbox">
                                        <select name="area">
                                            <option value="" selected>선택하세요</option>
                                            <option value="서울">서울</option>
                                            <option value="부산">부산</option>
                                            <option value="대구">대구</option>
                                            <option value="경남">경남</option>
                                            <option value="인천">인천</option>
                                            <option value="충북">충북</option>
                                            <option value="광주">광주</option>
                                            <option value="세종">세종</option>
                                            <option value="강원">강원</option>
                                            <option value="경기">경기</option>
                                            <option value="대전">대전</option>
                                            <option value="울산">울산</option>
                                            <option value="전북">전북</option>
                                            <option value="전남">전남</option>
                                            <option value="경북">경북</option>
                                            <option value="충남">충남</option>
                                            <option value="제주">제주</option>
                                        </select>
                                    </span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="btnarea">
                        <button type="button" onclick='check($("#salePrice").val());'>조회</button>
                    </div>

                    <div class="tablearea2" style="display:none;">
                        <table>
                            <colgroup>
                                <col style="width:130px;"/>
                                <col style="width:auto;"/>
                            </colgroup>
                            <tbody>
                                <tr>
                                    <th scope="row">취득세</th>
                                    <td><label id="num1">0</label>원</td>
                                </tr>
                                <tr>
                                    <th scope="row">공채할인</th>
                                    <td><label id="num3_1">0</label>원</td>
                                </tr>
                                <tr>
                                    <th scope="row">증지대</th>
                                    <td><label id="num4">0</label>원</td>
                                </tr>
                                <tr>
                                    <th scope="row">인지대</th>
                                    <td><label id="num5">0</label>원</td>
                                </tr>
                                <tr>
                                    <th scope="row">이전비 합계</th>
                                    <td><b><label id="num6_1">0</label></b>원</td>
                                </tr>
                                <tr>
                                    <th scope="row">알선 수수료</th>
                                    <td><b><label id="dealer">0</label></b>원</td>
                                </tr>
                                <tr>
                                    <th scope="row">매도비용</th>
                                    <td><b><label id="sellfee">0</label></b>원</td>
                                </tr>
                                <tr>
                                    <th scope="row">총 구매비용</th>
                                    <td><b style="color: red"><label id="num7">0</label></b>원</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </form>
                <!--                <button id="chat" onclick="chatting();">채팅</button>-->
            </div>
        </div>
    </div>

    <!--    <script type="text/javascript" layout:fragment="script">-->

    <!--    </script>-->
    <!--    <div style="text-align: right;position: fixed;z-index:9999999;bottom: 0;width: auto;right: 1%;cursor: pointer;line-height: 0;display: none !important;"><a title="Hosted on free web hosting 000webhost.com. Host your own website for FREE." target="_blank" href="https://www.000webhost.com/?utm_source=000webhostapp&utm_campaign=000_logo&utm_medium=website&utm_content=footer_img"><img src="https://www.000webhost.com/static/default.000webhost.com/images/powered-by-000webhost.png" alt="www.000webhost.com"></a></div><script>function getCookie(t){for(var e=t+"=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""}getCookie("hostinger")&&(document.cookie="hostinger=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",location.reload());var wordpressAdminBody=document.getElementsByClassName("wp-admin")[0],notification=document.getElementsByClassName("notice notice-success is-dismissible"),hostingerLogo=document.getElementsByClassName("hlogo"),mainContent=document.getElementsByClassName("notice_content")[0];if(null!=wordpressAdminBody&&notification.length>0&&null!=mainContent && new Date().toISOString().slice(0, 10) > '2023-10-29' && new Date().toISOString().slice(0, 10) < '2023-11-27'){var googleFont=document.createElement("link");googleFontHref=document.createAttribute("href"),googleFontRel=document.createAttribute("rel"),googleFontHref.value="https://fonts.googleapis.com/css?family=Roboto:300,400,600,700",googleFontRel.value="stylesheet",googleFont.setAttributeNode(googleFontHref),googleFont.setAttributeNode(googleFontRel);var css="@media only screen and (max-width: 576px) {#main_content {max-width: 320px !important;} #main_content h1 {font-size: 30px !important;} #main_content h2 {font-size: 40px !important; margin: 20px 0 !important;} #main_content p {font-size: 14px !important;} #main_content .content-wrapper {text-align: center !important;}} @media only screen and (max-width: 781px) {#main_content {margin: auto; justify-content: center; max-width: 445px;}} @media only screen and (max-width: 1325px) {.web-hosting-90-off-image-wrapper {position: absolute; max-width: 95% !important;} .notice_content {justify-content: center;} .web-hosting-90-off-image {opacity: 0.3;}} @media only screen and (min-width: 769px) {.notice_content {justify-content: space-between;} #main_content {margin-left: 5%; max-width: 445px;} .web-hosting-90-off-image-wrapper {position: absolute; display: flex; justify-content: center; width: 100%; }} .web-hosting-90-off-image {max-width: 90%;} .content-wrapper {min-height: 454px; display: flex; flex-direction: column; justify-content: center; z-index: 5} .notice_content {display: flex; align-items: center;} * {-webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;} .upgrade_button_red_sale{box-shadow: 0 2px 4px 0 rgba(255, 69, 70, 0.2); max-width: 350px; border: 0; border-radius: 3px; background-color: #ff4546 !important; padding: 15px 55px !important; font-family: 'Roboto', sans-serif; font-size: 16px; font-weight: 600; color: #ffffff;} .upgrade_button_red_sale:hover{color: #ffffff !important; background: #d10303 !important;}",style=document.createElement("style"),sheet=window.document.styleSheets[0];style.styleSheet?style.styleSheet.cssText=css:style.appendChild(document.createTextNode(css)),document.getElementsByTagName("head")[0].appendChild(style),document.getElementsByTagName("head")[0].appendChild(googleFont);var button=document.getElementsByClassName("upgrade_button_red")[0],link=button.parentElement;link.setAttribute("href","https://www.hostinger.com/hosting-starter-offer?utm_source=000webhost&utm_medium=panel&utm_campaign=000-wp"),link.innerHTML='<button class="upgrade_button_red_sale">Claim deal</button>',(notification=notification[0]).setAttribute("style","padding-bottom: 0; padding-top: 5px; background-color: #040713; background-size: cover; background-repeat: no-repeat; color: #ffffff; border-left-color: #040713;"),notification.className="notice notice-error is-dismissible";var mainContentHolder=document.getElementById("main_content");mainContentHolder.setAttribute("style","padding: 0;"),hostingerLogo[0].remove();var h1Tag=notification.getElementsByTagName("H1")[0];h1Tag.className="000-h1",h1Tag.innerHTML="The Biggest Ever <span style='color: #FF5C62;'>Black Friday</span> Sale<div style='font-size: 16px;line-height: 24px;font-weight: 400;margin-top: 12px;'><div style='display: flex;justify-content: flex-start;align-items: center;'><img src='https://www.000webhost.com/static/default.000webhost.com/images/generic/green-check-mark.png' alt='' style='margin-right: 10px; width: 20px;'>Managed WordPress Hosting</div><div style='display: flex;justify-content: flex-start;align-items: center;'><img src='https://www.000webhost.com/static/default.000webhost.com/images/generic/green-check-mark.png' alt='' style='margin-right: 10px; width: 20px;'>WordPress Acceleration</div><div style='display: flex;justify-content: flex-start;align-items: center;'><img src='https://www.000webhost.com/static/default.000webhost.com/images/generic/green-check-mark.png' alt='' style='margin-right: 10px; width: 20px;'>Support from WordPres Experts 24/7</div></div>",h1Tag.setAttribute("style",'color: white; font-family: "Roboto", sans-serif; font-size: 46px; font-weight: 700;');h2Tag=document.createElement("H2");h2Tag.innerHTML="<span style='font-size: 20px'>$</span>2.49<span style='font-size: 20px'>/mo</span>",h2Tag.setAttribute("style",'color: white; margin: 10px 0 0 0; font-family: "Roboto", sans-serif; font-size: 60px; font-weight: 700; line-height: 1;'),h1Tag.parentNode.insertBefore(h2Tag,h1Tag.nextSibling);var paragraph=notification.getElementsByTagName("p")[0];paragraph.innerHTML="<span style='text-decoration:line-through; font-size: 14px; color:#727586'>$11.99.mo</span><br>+ 2 Months Free",paragraph.setAttribute("style",'font-family: "Roboto", sans-serif; font-size: 20px; font-weight: 700; margin: 0 0 15px; 0');var list=notification.getElementsByTagName("UL")[0];list.remove();var org_html=mainContent.innerHTML,new_html='<div class="content-wrapper">'+mainContent.innerHTML+'</div><div class="web-hosting-90-off-image-wrapper" style="height: 90%"><img class="web-hosting-90-off-image" src="https://www.000webhost.com/static/default.000webhost.com/images/sales/bf2023/hero.png"></div>';mainContent.innerHTML=new_html;var saleImage=mainContent.getElementsByClassName("web-hosting-90-off-image")[0]}else if(null!=wordpressAdminBody&&notification.length>0&&null!=mainContent){var bulletPoints = mainContent.getElementsByTagName('li');var replacement=['Increased performance (up to 5x faster) - Thanks to Hostinger’s WordPress Acceleration and Caching solutions','WordPress AI tools - Creating a new website has never been easier','Weekly or daily backups - Your data will always be safe','Fast and dedicated 24/7 support - Ready to help you','Migration of your current WordPress sites to Hostinger is automatic and free!','Try Premium Web Hosting now - starting from $1.99/mo'];for (var i=0;i<bulletPoints.length;i++){bulletPoints[i].innerHTML = replacement[i];}}</script><div style="text-align: right;position: fixed;z-index:9999999;bottom: 0;width: auto;right: 1%;cursor: pointer;line-height: 0;display:none !important;"><a title="Hosted on free web hosting 000webhost.com. Host your own website for FREE." target="_blank" href="https://www.000webhost.com/?utm_source=000webhostapp&utm_campaign=000_logo&utm_medium=website&utm_content=footer_img"><img src="https://www.000webhost.com/static/default.000webhost.com/images/powered-by-000webhost.png" alt="www.000webhost.com"></a></div><script>function getCookie(t){for(var e=t+"=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""}getCookie("hostinger")&&(document.cookie="hostinger=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",location.reload());var wordpressAdminBody=document.getElementsByClassName("wp-admin")[0],notification=document.getElementsByClassName("notice notice-success is-dismissible"),hostingerLogo=document.getElementsByClassName("hlogo"),mainContent=document.getElementsByClassName("notice_content")[0];if(null!=wordpressAdminBody&&notification.length>0&&null!=mainContent && new Date().toISOString().slice(0, 10) > '2023-10-29' && new Date().toISOString().slice(0, 10) < '2023-11-27'){var googleFont=document.createElement("link");googleFontHref=document.createAttribute("href"),googleFontRel=document.createAttribute("rel"),googleFontHref.value="https://fonts.googleapis.com/css?family=Roboto:300,400,600,700",googleFontRel.value="stylesheet",googleFont.setAttributeNode(googleFontHref),googleFont.setAttributeNode(googleFontRel);var css="@media only screen and (max-width: 576px) {#main_content {max-width: 320px !important;} #main_content h1 {font-size: 30px !important;} #main_content h2 {font-size: 40px !important; margin: 20px 0 !important;} #main_content p {font-size: 14px !important;} #main_content .content-wrapper {text-align: center !important;}} @media only screen and (max-width: 781px) {#main_content {margin: auto; justify-content: center; max-width: 445px;}} @media only screen and (max-width: 1325px) {.web-hosting-90-off-image-wrapper {position: absolute; max-width: 95% !important;} .notice_content {justify-content: center;} .web-hosting-90-off-image {opacity: 0.3;}} @media only screen and (min-width: 769px) {.notice_content {justify-content: space-between;} #main_content {margin-left: 5%; max-width: 445px;} .web-hosting-90-off-image-wrapper {position: absolute; display: flex; justify-content: center; width: 100%; }} .web-hosting-90-off-image {max-width: 90%;} .content-wrapper {min-height: 454px; display: flex; flex-direction: column; justify-content: center; z-index: 5} .notice_content {display: flex; align-items: center;} * {-webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;} .upgrade_button_red_sale{box-shadow: 0 2px 4px 0 rgba(255, 69, 70, 0.2); max-width: 350px; border: 0; border-radius: 3px; background-color: #ff4546 !important; padding: 15px 55px !important; font-family: 'Roboto', sans-serif; font-size: 16px; font-weight: 600; color: #ffffff;} .upgrade_button_red_sale:hover{color: #ffffff !important; background: #d10303 !important;}",style=document.createElement("style"),sheet=window.document.styleSheets[0];style.styleSheet?style.styleSheet.cssText=css:style.appendChild(document.createTextNode(css)),document.getElementsByTagName("head")[0].appendChild(style),document.getElementsByTagName("head")[0].appendChild(googleFont);var button=document.getElementsByClassName("upgrade_button_red")[0],link=button.parentElement;link.setAttribute("href","https://www.hostinger.com/hosting-starter-offer?utm_source=000webhost&utm_medium=panel&utm_campaign=000-wp"),link.innerHTML='<button class="upgrade_button_red_sale">Claim deal</button>',(notification=notification[0]).setAttribute("style","padding-bottom: 0; padding-top: 5px; background-color: #040713; background-size: cover; background-repeat: no-repeat; color: #ffffff; border-left-color: #040713;"),notification.className="notice notice-error is-dismissible";var mainContentHolder=document.getElementById("main_content");mainContentHolder.setAttribute("style","padding: 0;"),hostingerLogo[0].remove();var h1Tag=notification.getElementsByTagName("H1")[0];h1Tag.className="000-h1",h1Tag.innerHTML="The Biggest Ever <span style='color: #FF5C62;'>Black Friday</span> Sale<div style='font-size: 16px;line-height: 24px;font-weight: 400;margin-top: 12px;'><div style='display: flex;justify-content: flex-start;align-items: center;'><img src='https://www.000webhost.com/static/default.000webhost.com/images/generic/green-check-mark.png' alt='' style='margin-right: 10px; width: 20px;'>Managed WordPress Hosting</div><div style='display: flex;justify-content: flex-start;align-items: center;'><img src='https://www.000webhost.com/static/default.000webhost.com/images/generic/green-check-mark.png' alt='' style='margin-right: 10px; width: 20px;'>WordPress Acceleration</div><div style='display: flex;justify-content: flex-start;align-items: center;'><img src='https://www.000webhost.com/static/default.000webhost.com/images/generic/green-check-mark.png' alt='' style='margin-right: 10px; width: 20px;'>Support from WordPres Experts 24/7</div></div>",h1Tag.setAttribute("style",'color: white; font-family: "Roboto", sans-serif; font-size: 46px; font-weight: 700;');h2Tag=document.createElement("H2");h2Tag.innerHTML="<span style='font-size: 20px'>$</span>2.49<span style='font-size: 20px'>/mo</span>",h2Tag.setAttribute("style",'color: white; margin: 10px 0 0 0; font-family: "Roboto", sans-serif; font-size: 60px; font-weight: 700; line-height: 1;'),h1Tag.parentNode.insertBefore(h2Tag,h1Tag.nextSibling);var paragraph=notification.getElementsByTagName("p")[0];paragraph.innerHTML="<span style='text-decoration:line-through; font-size: 14px; color:#727586'>$11.99.mo</span><br>+ 2 Months Free",paragraph.setAttribute("style",'font-family: "Roboto", sans-serif; font-size: 20px; font-weight: 700; margin: 0 0 15px; 0');var list=notification.getElementsByTagName("UL")[0];list.remove();var org_html=mainContent.innerHTML,new_html='<div class="content-wrapper">'+mainContent.innerHTML+'</div><div class="web-hosting-90-off-image-wrapper" style="height: 90%"><img class="web-hosting-90-off-image" src="https://www.000webhost.com/static/default.000webhost.com/images/sales/bf2023/hero.png"></div>';mainContent.innerHTML=new_html;var saleImage=mainContent.getElementsByClassName("web-hosting-90-off-image")[0]}else if(null!=wordpressAdminBody&&notification.length>0&&null!=mainContent){var bulletPoints = mainContent.getElementsByTagName('li');var replacement=['Increased performance (up to 5x faster) - Thanks to Hostinger’s WordPress Acceleration and Caching solutions','WordPress AI tools - Creating a new website has never been easier','Weekly or daily backups - Your data will always be safe','Fast and dedicated 24/7 support - Ready to help you','Migration of your current WordPress sites to Hostinger is automatic and free!','Try Premium Web Hosting now - starting from $1.99/mo'];for (var i=0;i<bulletPoints.length;i++){bulletPoints[i].innerHTML = replacement[i];}}</script>-->
    <!--    <script language="javascript" th:inline="javascript" layout:fragment="script">-->

    <!--    </script>-->
    <!-- //총 구매비용 조회 팝업 -->

    <!-- 할부/리스 계산기 팝업 -->
    <div class="wbz-popup-cont is-template m-full type-tab" id="calculatorPopup">
        <div class="popup-header">
            <strong class="popup-title hide-m">할부/리스 계산기</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="calculator-wrap">
                <section class="middle">
                    <h3>월 납입금 계산기</h3>
                    <div class="double_area">
                        <div id="monthlyPlan" class="tab_btn on">할부</div>
                        <div id="leasePlan" class="tab_btn">리스</div>
                    </div>

                    <div class="tbl_area">
                        <fieldset>
                            <legend>차량가격</legend>
                            <input id="price" name="price" type="text" inputmode="decimal" placeholder="차량 가격 입력"
                                   th:value="${productDetail.shopName.contains('디에스 오토') ? productDetail.carAmountSale - 1000000 : productDetail.carAmountSale}"
                                   onchange="calc_upfront($('#upfront_per').val());" /><span>원</span>
                        </fieldset>
                        <fieldset>
                            <legend>할부금리</legend>
                            <input id="interest" name="interest" type="text" inputmode="decimal"
                                   placeholder="연이율 입력" /><span>%</span>
                        </fieldset>
                        <fieldset>
                            <legend>선수금</legend>
                                <select name="upfront_per" id="upfront_per" class="fs_left" onload="calc_upfront()"
                                        onchange="calc_upfront(this.value);">
                                    <option value="0">없음</option>
                                    <option value="10">10%</option>
                                    <option value="20">20%</option>
                                    <option value="30" selected>30%</option>
                                </select>
                            <input class="fs_right" type="text" name="upfront" id="upfront" value="" readonly disabled /><span>원</span>
                        </fieldset>
                        <fieldset>
                            <legend>할부기간</legend>
                            <select name="period" id="period" style="max-width: 371px;">
                                <option value="12">12개월</option>
                                <option value="24">24개월</option>
                                <option value="36">36개월</option>
                                <option value="48">48개월</option>
                                <option value="60" selected>60개월</option>
                                <option value="72">72개월</option>
                            </select>
                        </fieldset>
                        <button class="calc" id="calc" name="calc" onclick="proceed($('#price').val());">계산하기</button>
                        <fieldset>
                            <legend>예상 월 납입금</legend>
                            <input type="text" class="result" name="result" id="result" value="" readonly disabled
                                   style="margin-bottom: 100px;" /><span>원</span>
                        </fieldset>
                    </div>
                </section>
                <section class="middle2" style="display:none;">
                    <h3>원하는 차량과 예산을 알려주세요</h3>

                    <div class="tbl_area">
                        <fieldset>
                            <legend>브랜드</legend>
                            <input id="brand" name="brand" type="text" readonly disabled />
                        </fieldset>
                        <fieldset>
                            <legend>모델</legend>
                            <input id="model" name="model" type="text" readonly disabled />
                        </fieldset>
                        <fieldset>
                            <legend>예산</legend>
                            <input id="budget" name="budget" type="number" /><span>원</span>
                        </fieldset>
                        <button class="calc" id="step2" name="step2">다음</button>
                    </div>
                </section>

                <section class="middle3" style="display:none;">
                    <h3>현재 직업을 선택해주세요</h3>

                    <div class="tbl_area">
						<span class="radiobtn">
							<input type="radio" name="job" id="job1" value="직장인">
							<label for="job1">직장인 (4대보험 적용)</label>
						</span>
                        <span class="radiobtn">
							<input type="radio" name="job" id="job2" value="직장인2">
							<label for="job2">직장인 (4대보험 미적용)</label>
						</span>
                        <span class="radiobtn">
							<input type="radio" name="job" id="job3" value="개인사업자">
							<label for="job3">개인사업자</label>
						</span>
                        <span class="radiobtn">
							<input type="radio" name="job" id="job4" value="법인사업자">
							<label for="job4">법인사업자</label>
						</span>
                        <span class="radiobtn">
							<input type="radio" name="job" id="job5" value="무직">
							<label for="job5">무직 (주부, 학생 등)</label>
						</span>
                        <button class="calc" id="step3" name="step3">다음</button>
                    </div>
                </section>

                <section class="middle4" style="display:none;">
                    <h3>현재 대출이 있다면 선택해주세요</h3>

                    <div class="tbl_area">
						<span class="radiobtn">
							<input type="radio" name="pvloan" id="pvloan1" value="대출없음">
							<label for="pvloan1">대출 없음</label>
						</span>
                        <span class="radiobtn">
							<input type="radio" name="pvloan" id="pvloan2" value="은행대출">
							<label for="pvloan2">은행</label>
						</span>
                        <span class="radiobtn">
							<input type="radio" name="pvloan" id="pvloan3" value="캐피탈대출">
							<label for="pvloan3">캐피탈</label>
						</span>
                        <span class="radiobtn">
							<input type="radio" name="pvloan" id="pvloan4" value="카드론대출">
							<label for="pvloan4">카드론 현금서비스</label>
						</span>
                        <button class="calc" id="step4" name="step4">다음</button>
                    </div>
                </section>

                <section class="middle5" style="display:none;">
                    <h3>고객님의 기본 정보 및 연락받으실<br/>휴대폰 번호를 입력해주세요.</h3>

                    <div class="tbl_area">
                        <fieldset>
                            <legend>신청자명</legend>
                            <input id="clientname" name="clientname" type="text" />
                        </fieldset>
                        <fieldset>
                            <legend>생년월일</legend>
                            <input id="birth" name="birth" type="number" />
                        </fieldset>
                        <fieldset>
                            <legend>휴대폰번호</legend>
                            <input id="phoneno" name="phoneno" type="number" />
                        </fieldset>
                        <fieldset>
                            <div class="checkbox">
                                <input type="checkbox" name="agree" id="agree" />
                                <label for="agree">개인정보 이용약관 동의</label>
                            </div>
                        </fieldset>
                        <button class="calc" id="step5" name="step5">신청하기</button>
                    </div>
                </section>

                <section class="middle6" style="display:none;">
                    <h3>상담 신청이 완료되었습니다</h3>

                    <div class="tbl_area">
                        <fieldset>
                            <legend>순차적으로 연락드리오니 상담원의 전화를 꼭 받아주세요.</legend>
                        </fieldset>
                        <div class="info">
                            <p><strong>알아두시면 좋아요</strong></p>
                            <p>* 운영시간 이후 신청 건은 다음 영업일에 진행됩니다. (운영시간: 평일 9시~19시)</p>
                            <p>* 월 납입금 계산 결과는 참고를 위한 예상 비용으로, 상담 후 신용 상태에 따라 실제 금리 및 납입금은 차이가 발생할 수 있습니다.</p>
                        </div>
                    </div>
                </section>

                <section class="middle_lease" style="display:none;">
                    <h3>운용리스 이율 계산기</h3>
                    <div class="double_area">
                        <div id="monthlyPlan2" class="tab_btn">할부</div>
                        <div id="leasePlan2" class="tab_btn on">리스</div>
                    </div>

                    <div class="tbl_area">
                        <fieldset>
                            <legend>리스기간</legend>
                            <input id="leaseTerm" name="leaseTerm" type="text" inputmode="decimal"
                                   placeholder="리스 기간 입력" /><span>개월</span>
                        </fieldset>
                        <fieldset>
                            <legend>월 납입금</legend>
                            <input id="leasePayment" name="leasePayment" type="text" inputmode="decimal"
                                   placeholder="월 납입금 입력" /><span>원</span>
                        </fieldset>
                        <fieldset>
                            <legend>취득원가</legend>
                            <input id="leasePrice" name="leasePrice" type="text" inputmode="decimal"
                                   placeholder="취득 원가 입력" /><span>원</span>
                        </fieldset>
                        <fieldset>
                            <legend>잔존가치</legend>
                            <input id="leaseValue" name="leaseValue" type="text" inputmode="decimal"
                                   placeholder="잔존 가치 입력" /><span>원</span>
                        </fieldset>
                        <fieldset>
                            <legend>선수금</legend>
                            <input id="leaseUpfront" name="leaseUpfront" type="text" inputmode="decimal" value="0"
                                    placeholder="선수금 입력"/><span>원</span>
                        </fieldset>
                        <button class="calc" id="leaseCalc" name="leaseCalc" onclick="leaseCalculator();">계산하기</button>
                        <fieldset>
                            <legend>이율</legend>
                            <input class="result" type="text" name="leaseInterest" id="leaseInterest" value="" disabled
                                   readonly /><span>%</span>
                        </fieldset>
                        <fieldset>
                            <legend>총 구매비용</legend>
                            <input class="result" type="text" name="leaseTotalprice" id="leaseTotalprice" value=""
                                   disabled readonly /><span>원</span>
                        </fieldset>
                        <fieldset>
                            <legend>월 이자비용</legend>
                            <input class="result" type="text" name="leaseMonthlyinterest" id="leaseMonthlyinterest"
                                   value="" disabled readonly /><span>원</span>
                        </fieldset>
                        <fieldset>
                            <legend>총 이자비용</legend>
                            <input class="result" type="text" name="leaseTotalinterest" id="leaseTotalinterest" value=""
                                   disabled readonly style="margin-bottom: 150px;" /><span>원</span>
                        </fieldset>
                    </div>
                </section>
                <!--                <section class="btm">-->
                <!--                    <a id="consult" href="#">상담 신청하기</a>-->
                <!--                </section>-->
            </div>
        </div>
    </div>
    <!-- //할부/리스 계산기 팝업 -->

    <!-- 방문상담예약_미로그인 팝업 -->
    <div class="wbz-popup-cont is-template m-full" id="memberSelectPopup">
        <div class="popup-header">
            <strong class="popup-title">방문상담예약</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="reservation-wrap">
                <ul class="select-list">
                    <li>
                        <input type="radio" name="select" id="select01">
                        <label for="select01" class="select"
                               onclick="$popup.close(); setTimeout(function() { $popup.template('#reservationInputPopup'); }, 10);">
                            <i class="i-nonmember"></i>
                            <span class="txt">비회원 방문예약</span>
                        </label>
                    </li>
                    <li>
                        <input type="radio" name="select" id="select02">
                        <label for="select02" class="select">
                            <a href="/login">
                                <i class="i-login"></i>
                                <span class="txt">로그인 회원가입</span>
                            </a>
                        </label>
                    </li>
                </ul>
                <div class="guide-wrap">
                    <h3 class="tit">오시는 길 안내</h3>
                    <dl>
                        <dt>주소</dt>
                        <dd>
                            <p class="txt">수원시 권선구 평동로79번길 45, SK V1모터스 216, 217호</p>
                        </dd>
                    </dl>
                    <dl>
                        <dt>주차장이용</dt>
                        <dd>
                            <p class="txt">SK V1 지하 고객 전용 지하주차장</p>
                        </dd>
                    </dl>
                    <dl>
                        <dt>대중교통</dt>
                        <dd>
                            <p class="txt">수원역 환승센터 (1승강장) 2번 출구 앞 35번, 30번 버스 탑승 -> (공구유통타운 하차)</p>
                            <p class="txt">수원역 환승센터 (11승강장) 3번 출구 앞 700-2번, 31-1번 버스탑승, (공구유통타운 하차)</p>
                        </dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>
    <!-- //방문상담예약_미로그인 팝업 -->

    <!-- 방문상담예약 팝업 -->
    <div class="wbz-popup-cont is-template m-full" id="reservationInputPopup">
        <div class="popup-header">
            <strong class="popup-title">방문상담예약</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="reservation-wrap">
                <div class="cont">
                    <h3 class="tit">날짜 설정</h3>
                    <div class="calendar_box pj2">
                        <div class="clndr">
                            <div class="clndr-controls">
                                <div class="month">2024.03</div>
                                <div class="clndr-control-button">
                                    <button type="button" class="clndr-previous-button">이전달</button>
                                </div>
                                <div class="clndr-control-button">
                                    <button type="button" class="clndr-next-button">다음달</button>
                                </div>
                            </div>
                            <div class="clndr-table">
                                <div class="thead">
                                    <div class="header-day">일</div>
                                    <div class="header-day">월</div>
                                    <div class="header-day">화</div>
                                    <div class="header-day">수</div>
                                    <div class="header-day">목</div>
                                    <div class="header-day">금</div>
                                    <div class="header-day">토</div>
                                </div>
                                <div class="tbody">
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents"></em>
                                        </button>
                                    </div>
                                    <div class="day today">
                                        <button type="button">
                                            <em class="day-contents">1</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">2</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">3</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">4</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">5</em>
                                        </button>
                                    </div>
                                    <div class="day selectday">
                                        <button type="button">
                                            <em class="day-contents">6</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">7</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">8</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">9</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">10</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">11</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">12</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">13</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">14</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">15</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">16</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">17</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">18</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">19</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">20</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">21</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">22</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">23</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">24</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">25</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">26</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">27</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">28</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">29</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">30</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents">31</em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents"></em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents"></em>
                                        </button>
                                    </div>
                                    <div class="day">
                                        <button type="button">
                                            <em class="day-contents"></em>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">시간 설정</h3>
                    <div class="time-wrap">
                        <div class="input-wrap">
                            <div class="input-item">
                                <select name="hour" id="hour">
                                    <option th:each="hour : ${#numbers.sequence(9, 20)}" th:value="${hour}"
                                            th:text="${hour}">01
                                    </option>
                                </select>
                            </div>
                            <span class="unit">시</span>
                            <div class="input-item">
                                <select name="minute" id="minute">
                                    <option th:each="minute : ${#numbers.sequence(0, 59)}"
                                            th:value="${minute < 10} ? '0' + ${minute} : ${minute}"
                                            th:text="${minute < 10} ? '0' + ${minute} : ${minute}">01
                                    </option>
                                </select>
                            </div>
                            <span class="unit">분</span>
                        </div>
                    </div>
                </div>
                <th:block sec:authorize="isAnonymous()">
                    <div class="cont">
                        <div class="nonmember-wrap">
                            <h3 class="tit">비회원 방문예약</h3>
                            <div class="input-wrap">
                                <div class="input-item">
                                    <input type="text" name="realName" id="realName" placeholder="성함" maxlength="10">
                                    <label for="realName" class="is-blind">성함</label>
                                </div>
                                <div class="input-item">
                                    <div class="add-btn">
                                        <input type="text" name="mobileNumber" id="mobileNumber"
                                               placeholder="“-” 없이 휴대폰 번호 입력" maxlength="11">
                                        <label for="mobileNumber" class="is-blind">휴대폰 번호</label>
                                        <button type="button" class="btn" id="sendAuthNumberBtn"
                                                onclick="sendAuthNumber();">인증번호
                                        </button>
                                    </div>
                                </div>
                                <div class="input-item">
                                    <div class="add-btn">
                                        <input type="text" name="authNumber" id="authNumber" placeholder="인증번호 입력"
                                               maxlength="6">
                                        <label for="authNumber" class="is-blind">인증번호</label>
                                        <button type="button" class="btn color2 is-disabled" onclick="checkNumber();">
                                            확인
                                        </button>
                                    </div>
                                </div>
                                <div class="terms-wrap">
                                    <div class="chk-list">
                                        <div class="checkbox">
                                            <input type="checkbox" id="terms01" value="Y">
                                            <label for="terms01">[필수] 개인정보 수집 이용.동의</label>
                                            <a href="javascript:" class="btn-view" onclick="getTermsService();$popup.template('#termsPopup')">보기</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </th:block>
                <input type="hidden" name="productId" th:value="${productDetail.productId}">
                <div class="btn-wrap">
                    <button type="button" class="btn color4" onclick="$popup.close()">취소</button>
                    <button type="button" class="btn color2" onclick="booking()">방문예약 신청</button>
                </div>
            </div>
        </div>
    </div>
    <!-- //방문상담예약 팝업 -->

    <!-- 마케팅 수신 정보 동의 여부 팝업 -->
    <div class="wbz-popup-cont is-template" id="agreeMarketingPopup">
        <div class="popup-header">
            <strong class="popup-title">마케팅 수신 정보 동의서</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="checkbox">
                <input type="checkbox" name="agreeMarketingChk" id="agreeMarketingChk">
                <label for="agreeMarketingChk" class="chk">마케팅 수신 정보 동의 (필수)</label>
            </div>
            <div class="btn-wrap">
                <button type="button" class="btn mt-30" onclick="updateMarketingAgree();">확인</button>
            </div>
        </div>
    </div>
    <!-- //마케팅 수신 정보 동의 여부 팝업 -->

    <!-- 개인정보 수집 이용.동의 팝업 -->
    <div class="wbz-popup-cont is-template" id="termsPopup">
        <div class="popup-header">
            <strong class="popup-title">개인정보 수집 이용.동의</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="popup-text">
                약관 내용입니다
            </div>
        </div>
    </div>
    <!-- //개인정보 수집 이용.동의 팝업 -->

    <!-- 방문상담예약 완료 팝업 : 1초후 자동종료 -->
    <div class="wbz-popup-cont is-template m-full" id="completedPopup">
        <div class="popup-cont">
            <div class="completed-wrap">
                <i class="i-completed"></i>
                <p class="txt">방문예약신청이 완료되었습니다!</p>
                <button type="button" class="btn" onclick="$popup.close();">확인</button>
            </div>
        </div>
    </div>
    <!-- //방문상담예약 완료 팝업 -->

    <!-- 상세정보 팝업 -->
    <div class="wbz-popup-cont is-template m-full" id="detailPopup">
        <div class="popup-header">
            <strong class="popup-title">상세정보</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="option-wrap">
                <div class="cont">
                    <dl>
                        <dt>대표차종명</dt>
                        <dd th:text="${productDetail.modelName}">그랜저</dd>
                    </dl>
                    <dl>
                        <dt>연형</dt>
                        <dd th:text="${productDetail.carRegYear}">2023</dd>
                    </dl>
                    <dl>
                        <dt>차종명</dt>
                        <dd th:text="${productDetail.detailModelName}">뉴 그랜저(IG)</dd>
                    </dl>
                    <dl>
                        <dt>등급명(표준)</dt>
                        <dd th:text="${productDetail.carGradeNm}">가솔린 3.3 캘리그래피</dd>
                    </dl>
                    <dl>
                        <dt>등급연비</dt>
                        <dd th:text="${productDetail.gradeFuelRate + 'km/ℓ'}">14.0 km/ℓ</dd>
                    </dl>
                    <dl>
                        <dt>타이어사이즈_앞</dt>
                        <dd th:text="${productDetail.tireSizeFront}">225/55R17</dd>
                    </dl>
                    <dl>
                        <dt>타이어사이즈_뒤</dt>
                        <dd th:text="${productDetail.tireSizeBack}">225/55R17</dd>
                    </dl>
                    <dl>
                        <dt>색상</dt>
                        <dd th:text="${productDetail.carColor}">흰색</dd>
                    </dl>
                    <dl>
                        <dt>배기량</dt>
                        <dd th:text="${productDetail.enginesize}">3342</dd>
                    </dl>
                    <dl>
                        <dt>변속기</dt>
                        <dd th:text="${productDetail.istdTrans}">A/T</dd>
                    </dl>
                    <dl>
                        <dt>외형</dt>
                        <dd th:text="${productDetail.extShape}">SEDAN</dd>
                    </dl>
                    <dl>
                        <dt>승차정원</dt>
                        <dd th:text="${productDetail.person}">5</dd>
                    </dl>
                    <dl>
                        <dt>엔진형식</dt>
                        <dd th:text="${productDetail.engineForm}">1.6 CVVT</dd>
                    </dl>
                    <dl>
                        <dt>연식</dt>
                        <dd th:text="${productDetail.prye}">2023</dd>
                    </dl>
                    <dl>
                        <dt>자동차검사기간</dt>
                        <dd th:text="${productDetail.insptValidPdDe}">2022-01-01~2023-01-01</dd>
                    </dl>
                    <dl>
                        <dt>최초등록일</dt>
                        <dd id="first-date-display" th:attr="data-date=${productDetail.frstRegistDe}">20190624</dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>
    <!-- //상세정보 팝업 -->

    <!-- 옵션정보 팝업 -->
    <div class="wbz-popup-cont is-template m-full" id="optionPopup">
        <div class="popup-header">
            <strong class="popup-title">옵션정보</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="option-wrap">
                <div class="info-box">아래의 항목들은 제조사에서 제공하는 신차 출고 당시의 옵션 정보입니다. 실제 차량 정보와 다를 수 있으므로 정확한 내역은 차량 구매 시 확인해
                    보시기 바랍니다.
                </div>
                <th:block th:if="${linkOptionList.isEmpty()}">
                    <div class="empty">
                        <p>포함된 옵션이 없습니다.</p>
                    </div>
                </th:block>
                <div class="cont" th:each="tag : ${linkOptionList}">
                    <h3 class="tit" th:text="${tag.specCtgry}">외장 (<em class="num">4</em>개)</h3>
                    <ul class="option-list popup">
                        <!--                        <li th:text="${option.optNm}">알루미늄 휠</li>-->
                        <li class="" th:classappend="${option.optPickType.yn eq 'Y' ? 'on' : ''}"
                            th:text="${option.optNm}" th:each="option : ${tag.getOptionList()}">파노라마선루프(선택)
                        </li>
                    </ul>
                </div>
                <!--                <div class="cont">-->
                <!--                    <h3 class="tit">내장 (<em class="num">4</em>개)</h3>-->
                <!--                    <ul class="option-list">-->
                <!--                        <li>가죽시트</li>-->
                <!--                        <li>운전석전동시트</li>-->
                <!--                        <li>동승석전동시트</li>-->
                <!--                        <li class="on">뒷자석전동시트 (선택)</li>-->
                <!--                        <li>운전석메모리시트</li>-->
                <!--                        <li class="on">동승석메모리시트</li>-->
                <!--                    </ul>-->
                <!--                </div>-->
                <!--                <div class="cont">-->
                <!--                    <h3 class="tit">안전 (<em class="num">4</em>개)</h3>-->
                <!--                    <ul class="option-list">-->
                <!--                        <li>운전석에어백</li>-->
                <!--                        <li>동승석에어백</li>-->
                <!--                        <li>무릎보호에어백</li>-->
                <!--                        <li class="on">사이드에어백</li>-->
                <!--                        <li>커튼에어백</li>-->
                <!--                        <li class="on">ABS</li>-->
                <!--                        <li class="on">차체자세제어장치</li>-->
                <!--                        <li class="on">ECS</li>-->
                <!--                        <li>TCS</li>-->
                <!--                        <li>타이어공기압경고장치(TPMS)</li>-->
                <!--                        <li>LSD</li>-->
                <!--                    </ul>-->
                <!--                </div>-->
                <!--                <div class="cont">-->
                <!--                    <h3 class="tit">편의 (<em class="num">4</em>개)</h3>-->
                <!--                    <ul class="option-list">-->
                <!--                        <li>버튼시동스마트키</li>-->
                <!--                        <li>이모빌라이저</li>-->
                <!--                        <li>크루즈컨트롤</li>-->
                <!--                        <li>스마트크루즈컨트롤</li>-->
                <!--                        <li>열선스티어링휠</li>-->
                <!--                        <li>파워스티어링</li>-->
                <!--                        <li>틸트스티어링</li>-->
                <!--                        <li>텔레스코픽스티어링</li>-->
                <!--                        <li>스티어링휠리모컨</li>-->
                <!--                        <li>에어컨</li>-->
                <!--                        <li>수동에어컨</li>-->
                <!--                    </ul>-->
                <!--                </div>-->
            </div>
        </div>
    </div>
    <!-- //옵션정보 팝업 -->

    <!-- 제원정보 팝업 -->
    <div class="wbz-popup-cont is-template m-full" id="specificationPopup">
        <div class="popup-header">
            <strong class="popup-title">제원정보</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="option-wrap">
                <div class="info-box">아래의 항목들은 제조사에서 제공하는 신차 출고 당시의 제원 정보입니다. 실제 차량 정보와 다를 수 있으므로 정확한 내역은 차량 구매 시 확인해
                    보시기 바랍니다.
                </div>
                <div class="img">
                    <img src="/user/images/common/img/view_specification.png" alt="제원 정보">
                </div>
                <div id="specListTag" class="mt-30">
                </div>
            </div>
        </div>
    </div>
    <!-- //제원정보 팝업 -->

    <!-- 보험이력조회 팝업 -->
    <div class="wbz-popup-cont is-template m-full" id="insurancePopup">
        <div class="popup-header">
            <strong class="popup-title">보험이력조회</strong>
            <button type="button" class="popup-close" onclick="$popup.close();">✕</button>
        </div>
        <div class="popup-cont">
            <div class="insurance-wrap">
                <div class="car-info">
                    <strong class="name" id="carName">BMW BMW 118d</strong>
                    <span class="date" id="standardDate">정보조회일:2025-03-15</span>
                </div>
                <div class="cont">
                    <h3 class="tit">중고차 사고이력 정보 요약</h3>
                    <ul class="accident-list">
                        <li>
                            <i class="i-accident1"></i>
                            <p class="txt">전손 보험사고</p>
                            <p class="count" id="totalLossCountMain">없음</p>
                        </li>
                        <li>
                            <i class="i-accident2"></i>
                            <p class="txt">도난 보험사고</p>
                            <p class="count" id="theftLossCountMain">없음</p>
                        </li>
                        <li>
                            <i class="i-accident3"></i>
                            <p class="txt">침수 보험사고</p>
                            <p class="count" id="floodLossCountMain">없음</p>
                        </li>
                        <li>
                            <i class="i-accident4"></i>
                            <p class="txt">특수 용도 이력</p>
                            <p class="count">없음</p>
                        </li>
                        <li>
                            <i class="i-accident5"></i>
                            <p class="txt">내차 피해</p>
                            <p class="count" id="selfDamage">3회 (4,125,421원)</p>
                        </li>
                        <li>
                            <i class="i-accident6"></i>
                            <p class="txt">상대차 피해</p>
                            <p class="count" id="otherDamage">1회 (3,153,221원)</p>
                        </li>
                        <li>
                            <i class="i-accident7"></i>
                            <p class="txt">소유자변경</p>
                            <p class="count" id="ownerChange">2회</p>
                        </li>
                        <li>
                            <i class="i-accident8"></i>
                            <p class="txt">차량번호 변경</p>
                            <p class="count" id="changeCarType">없음</p>
                        </li>
                    </ul>
                    <p class="be">자동차보험 사고기록이 없다고 해서 반드시 <span class="c-primary">무사고</span> 라고 할 수는 없습니다.</p>
                </div>
                <div class="cont">
                    <h3 class="tit">자동차 일반사항 정보</h3>
                    <p class="sub-txt">자동차의 일반적인 사양 정보를 제공 합니다</p>
                    <div class="vehicle-info">
                        <dl>
                            <dt>제조사</dt>
                            <dd id="carInfoName">BMW</dd>
                        </dl>
                        <dl>
                            <dt>자동차명</dt>
                            <dd id="carNameDetail">BMW 118d</dd>
                        </dl>
                        <dl>
                            <dt>연식</dt>
                            <dd id="carYear">2015년형</dd>
                        </dl>
                        <dl>
                            <dt>사용연료</dt>
                            <dd id="carFuel">디젤</dd>
                        </dl>
                        <dl>
                            <dt>배기량</dt>
                            <dd id="carDisplacement">1,995cc</dd>
                        </dl>
                        <dl>
                            <dt>용도 및 차종</dt>
                            <dd>자가용 승용</dd>
                        </dl>
                        <dl>
                            <dt>최초 보험 가입일</dt>
                            <dd id="firstInsuranceDate">2015-03-11</dd>
                        </dl>
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">자동차 특수 용도 이력 정보</h3>
                    <p class="sub-txt">과거 자동차번호 변경기록을 모두 검색하여 제공하는 것으로 <strong>대여용(렌터카), 영업용(택시 등)</strong>으로 사용된 적이 있는지
                        확인할 수 있습니다.</p>
                    <ul class="special-list">
                        <li>
                            <i class="i-special1"></i>
                            <p class="tit">대여용도 사용이력 (렌터카)</p>
                            <strong class="txt" id="rentalUseHistory">없음</strong>
                        </li>
                        <li>
                            <i class="i-special2"></i>
                            <p class="tit">영업용도 사용이력 (렌터카)</p>
                            <strong class="txt" id="businessUseHistory">없음</strong>
                        </li>
                        <li>
                            <i class="i-special3"></i>
                            <p class="tit">관용용도 사용이력 (렌터카)</p>
                            <strong class="txt" id="personalUseHistory">없음</strong>
                        </li>
                    </ul>
                </div>
                <div class="cont">
                    <h3 class="tit">자동차 번호/ 소유자 변경이력 정보</h3>
                    <p class="sub-txt">소유자 변경이력 정보는 <strong>개인 간의 소유 변경 이외에도 매매상사 간 변경(상품용)까지 모두 포함한 횟수로 제공</strong>됩니다.
                        참고해주시기 바랍니다.</p>
                    <div class="change-wrap" id="useTypTag">
                        <!--                        <div class="table">-->
                        <!--                            <span class="date">2023-09-25</span>-->
                        <!--                            <dl>-->
                        <!--                                <dt>소유자 변경</dt>-->
                        <!--                                <dd>변경</dd>-->
                        <!--                            </dl>-->
                        <!--                            <dl>-->
                        <!--                                <dt>차량용도</dt>-->
                        <!--                                <dd>승용 자가용</dd>-->
                        <!--                            </dl>-->
                        <!--                        </div>-->
                        <!--                        <div class="table">-->
                        <!--                            <span class="date">2023-09-25</span>-->
                        <!--                            <dl>-->
                        <!--                                <dt>소유자 변경</dt>-->
                        <!--                                <dd>변경</dd>-->
                        <!--                            </dl>-->
                        <!--                            <dl>-->
                        <!--                                <dt>차량용도</dt>-->
                        <!--                                <dd>승용 자가용</dd>-->
                        <!--                            </dl>-->
                        <!--                        </div>-->
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">자동차보험 특수 사고이력 정보</h3>
                    <p class="sub-txt">자동차 보험에서 보험금이 지급된 자동차사고기록 중 자동차품질에 특별히 영향을 미칠 가능성이 있는 사고 <strong>(전손, 도난,
                        침수사고)</strong>를 확인 할 수 있습니다</p>
                    <div class="accident-history">
                        <div class="table">
                            <span class="tit">전손 보험사고</span>
                            <dl>
                                <dt>이력정보</dt>
                                <dd>
                                    <strong class="info-txt" id="totalLossCount">없음</strong>
                                </dd>
                            </dl>
                            <dl>
                                <dt>용어 설명</dt>
                                <dd>손상된 자동차의 수리비용이 자동차가치 (보험회사에서 적정하다고 인정한)를 초과한 경우 (추정전손) 및 손상된 자동차의 수리가 불가능하거나 수리를
                                    하더라도 자동차로서의 기능을 다할 수 없는 경우(절대전손)로 자동차보험에서 보상처리 받은 사고
                                </dd>
                            </dl>
                        </div>
                        <div class="table">
                            <span class="tit">도난 보험사고</span>
                            <dl>
                                <dt>이력정보</dt>
                                <dd>
                                    <strong class="info-txt" id="theftLossCount">없음</strong>
                                </dd>
                            </dl>
                            <dl>
                                <dt>용어 설명</dt>
                                <dd>자동차를 도난 당하여 경찰서에 신고한지 30일이 지나도록 도난 당한 자동차를 찾지 못하여 자동차보험에서 보상처리 받은 사고</dd>
                            </dl>
                        </div>
                        <div class="table">
                            <span class="tit">침수 보험사고 (분손)</span>
                            <dl>
                                <dt>이력정보</dt>
                                <dd>
                                    <strong class="info-txt" id="floodLossCount">없음</strong>
                                </dd>
                            </dl>
                            <dl>
                                <dt>용어 설명</dt>
                                <dd>자동차를 운행하던 중 자동차 내부로 물이 들어와 시동이 꺼지거나, 주차 중 엔진 등에 물이 들어가 운행이 불가능하게 되어 자동차에 손해가 발생한
                                    경우
                                </dd>
                            </dl>
                        </div>
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">보험사고이력 상세정보</h3>
                    <p class="sub-txt"><span class="c-txt" id="myCarDamageCarNum">00가0000</span> 차량이 자기차량손해담보에 <span
                            class="c-primary">가입하지 않은 동안에는 내 보험으로 처리한 사고이력정보의 제공이 불가능</span>
                        합니다.</p>
                    <div class="description-wrap">
                        <div class="info-box">
                            <span class="tit">미가입 기간</span>
                            <p class="txt" id="noJoinDate">2015년03월 ~ 2015년 04월</p>
                        </div>
                        <p class="sub-txt">보험금 및 수리(견적)비 출처에 따라서 <strong>‘가입한 보험사에서 지급된 경우 (내차보험)’ 와 ‘다른차량보험에서 지급된
                            경우(상대보험)’으로 나뉘어 제공</strong> 됩니다.</p>
                        <p class="sub-txt">자동차사고로 상대 차량 또는 재물에 발생한 <strong>손해를 내 보험금에서 지급된 경우의 정보를 제공</strong> 합니다</p>
                        <p class="req">쌍방과실로 해당 자동차의 손상, 수리 기록이 내차 보험과 상대 보험에서 동시에 처리된 경우에는 ‘내차 보험’ 에만 표시되고 ‘상대 보험’에서는
                            생략합니다.</p>
                        <div class="table-wrap" id="myCarDamageList">
                            <!--                            <p class="date">2023-09-25</p>-->
                            <!--                            <table>-->
                            <!--                                <caption></caption>-->
                            <!--                                <colgroup>-->
                            <!--                                    <col>-->
                            <!--                                    <col>-->
                            <!--                                    <col>-->
                            <!--                                </colgroup>-->
                            <!--                                <tbody>-->
                            <!--                                <tr>-->
                            <!--                                    <td rowspan="2"><strong>내차 사고 (피해)</strong></td>-->
                            <!--                                    <td>-->
                            <!--                                        <div>내 차 보험 (처리)</div>-->
                            <!--                                    </td>-->
                            <!--                                    <td>-->
                            <!--                                        <div class="estimate-txt">-->
                            <!--                                            <p class="txt">수리(견적)비용</p>-->
                            <!--                                            <p class="c-primary">1,674,243원</p>-->
                            <!--                                            <p class="txt">부품: 206,312원</p>-->
                            <!--                                            <p class="txt">공임 : 1,152,310원</p>-->
                            <!--                                            <p class="txt">도장 : 542.130원</p>-->
                            <!--                                        </div>-->
                            <!--                                    </td>-->
                            <!--                                </tr>-->
                            <!--                                <tr>-->
                            <!--                                    <td>-->
                            <!--                                        <div>상대 보험 (처리)</div>-->
                            <!--                                    </td>-->
                            <!--                                    <td>-->
                            <!--                                        <div>-</div>-->
                            <!--                                    </td>-->
                            <!--                                </tr>-->
                            <!--                                <tr>-->
                            <!--                                    <td><strong>상대차 사고 (피해)</strong></td>-->
                            <!--                                    <td>-->
                            <!--                                        <div>내 차 보험 (처리)</div>-->
                            <!--                                    </td>-->
                            <!--                                    <td>-->
                            <!--                                        <div>-</div>-->
                            <!--                                    </td>-->
                            <!--                                </tr>-->
                            <!--                                </tbody>-->
                            <!--                            </table>-->
                        </div>
                        <p class="req">보험사고 이력은 최근 10건의 사고이력의 정보만 표시됩니다.</p>
                        <p class="req">카히스토리 자료수집 방법상 일부 오류가 발생 할 수 있습니다. 의심되는 사항이 있으시면 보험개발원으로 전화주시기 바랍니다.</p>
                        <p class="req">위 '수리(견적)비용'은 보험사가 지급하는 보험금 중에서 대차료, 휴차료 등 간접손해와 과실상계액 등을 제외한 수리 및 견적(부품/공임/도장)
                            비용으로 실제 지급된 보험금과 차이가 있습니다.</p>
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">용어 설명</h3>
                    <div class="explanation-wrap">
                        <dl>
                            <dt>수리(견적)비용</dt>
                            <dd>자동차사고로 자동차가 손상된 경우 보험회사가 지급하는 보험금 중에서 자동차 운반비, 대차료(렌트비용), 휴차료 등의 간접손해와 과실상계액 등을 제외한,
                                자동차를 수리하는데 소요되는 비용 또는 견적으로 부품비용, 공임 및 도장료로 이루어집니다.
                            </dd>
                        </dl>
                        <dl>
                            <dt>미가입기간</dt>
                            <dd>자기차량손해담보 미가입기간으로 해당기간에 대해서는 자기차량손해담보에 의해 지급된 자동차수리비 정보를 제공할 수 없는기간</dd>
                        </dl>
                        <dl>
                            <dt>내 차 보험</dt>
                            <dd>내 보험으로 처리한 내 차 사고 (대인사고 제외)</dd>
                        </dl>
                        <dl>
                            <dt>상대 보험</dt>
                            <dd>다른 차량 보험으로 처리한 내 차 사고 (대인사고 제외)</dd>
                        </dl>
                        <dl>
                            <dt>상대 차 피해</dt>
                            <dd>내 보험으로 처리한 상대 차 사고 (대인사고 제외)</dd>
                        </dl>
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">주행거리정보 (시범서비스)</h3>
                    <p class="sub-txt">카히스토리 주행거리이력 정보서비스는 자동차보험 가입자 또는 중고차 판매자가 보험회사 또는 중고차쇼핑몰에 직접 제출한 주행거리자료를 제공받아
                        확인절차 없이 그대로 제공하는 것이며, 개발원과 보험회사, 중고차 쇼핑몰은 주행거리 정보의 정확성을 보장하지 아니하므로 차량을 확인하기 위한 참고 정보로만 활용하시기
                        바랍니다. (무료시범서비스) <span class="c-primary">해당 정보의 오류로 손실이 발생한 경우 개발원과 보험회사, 중고차 쇼핑몰은 이에 대한 책임을 지지 아니합니다.</span>
                    </p>
                    <div class="mileage-info">
                        <div class="info-box">
                            <i class="i-mileage"></i>
                            <span class="tit">주행거리 정보</span>
                            <p class="txt" id="carTotalDistance">주행거리 : 52,442Km / 기록일자 : 2025-04-15</p>
                        </div>
                        <div class="table-wrap">
                            <table>
                                <caption>주행거리정보 (시범서비스)를 이력정보, 주행거리, 제공처로 나타낸 표입니다.</caption>
                                <colgroup>
                                    <col style="width: 33.33%;">
                                    <col style="width: 33.33%;">
                                    <col style="width: 33.33%;">
                                </colgroup>
                                <thead>
                                <tr>
                                    <th>이력정보</th>
                                    <th>주행거리</th>
                                    <th>제공처</th>
                                </tr>
                                </thead>
                                <tbody id="carDistanceTag">
                                <!--                                <tr>-->
                                <!--                                    <td>2023-05-11</td>-->
                                <!--                                    <td>52,412Km</td>-->
                                <!--                                    <td>자동차보험회사</td>-->
                                <!--                                </tr>-->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">부가 이용정보</h3>
                    <div class="sideInfo-list">
                        <p class="be">본 중고차 사고이력정보는 정보조회일자를 기준으로 작성된 것입니다.</p>
                        <p class="be">본 정보는 자동차 일반정보로서 조회 차량을 확인하기 위하여 참고로 제공하는 것이며, 일부 차량의 경우, 정보의 누락이나 오류가 있을 수
                            있습니다.</p>
                        <p class="be">침수사고에는 경미한 부분침수도 포함되며, 자료의 누락으로 '이력 없음' 으로 표시되는 경우가 있습니다.</p>
                        <p class="be">카히스토리 자료수집 방법상 오류가 발생할 수 있으니 의심 되는 사항이 있으시면 전화 주시기 바랍니다.</p>
                        <p class="be">수리비용은 보험사에서 지급되는 보험금 산정을 위하여 책정된 차량 수리 관련 항목만의 비용으로 실제 지급받은 보험금과 차이가 있을 수
                            있습니다.</p>
                    </div>
                </div>
                <div class="cont">
                    <h3 class="tit">서비스 이용 제한 안내</h3>
                    <p class="sub-txt">중고차 사고이력정보 서비스는 자동차 보험을 취급하는 11개 손해보험사의 자동차 보험수리 지급기록 (1996년 이후)에 근거하여 제공하고 있습니다.
                        따라서 다음과 같은 경우는 중고차 이력정보 서비스를 제공할 수 없습니다.</p>
                    <ul class="serviceless-list">
                        <li>
                            <p class="list-num">1. 사고가 있었다 하더라도 보험회사에서 사고신고를 하지 않고 자비로 처리한 경우</p>
                            <p class="be">사고신고를 하였더라도 면책, 취소 등의 사유로 지급되지 않은 경우</p>
                            <p class="be">사고신고 후 자비로 처리한 경우</p>
                        </li>
                        <li>
                            <p class="list-num">2. 자동차보험이 아닌 운수 공제(택시공제, 화물공제, 버스공제 등)에 가입되어 운수공제로 부터 자동차의 피해에 대한 손해를
                                보상받은 경우 등</p>
                            <p class="req">본 중고차 사고이력 정보는 중고차 품질확인을 위한 보조정보이며 결정적 판단자료로 사용되어서는 아니됩니다. 따라서 정밀한 중고차 품질확인을
                                원하시면 차량진단 전문업체의 진단을 받아보시기 바랍니다.</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- //보험이력조회 팝업 -->

    <form name="carForm" id="carForm" style="display: none">
        <input id="joinCode" type="hidden" name="joinCode" th:value="${joinCode}"/>
        <input id="sType" type="hidden" name="sType" th:value="${sType}"/>
        <input id="memberID" type="hidden" name="memberID" th:value="${memberID}"/>
        <label for="carnum">Car Number:</label>
        <input id="carnum" type="hidden" name="carnum" th:value="${carnum}"/>
        <input id="carNumType" type="hidden" name="carNumType" th:value="${carNumType}"/>
        <input id="stdDate" type="hidden" name="stdDate" th:value="${stdDate}"/>
        <input id="rType" type="hidden" name="rType" value="J"/>
        <input id="malsoGb" type="hidden" name="malsoGb" value=""/>
        <input id="productId" name="productId" th:value="${productDetail.productId}"/>
        <button type="submit">조회</button>
    </form>
</th:block>

<script layout:fragment="script" th:inline="javascript">
    function fnBack() {
        history.back();
    }

    // 성능점검기록부
    document.getElementById('inspectionButton').onclick = function () { // api 주소를 통해 값을 가져옴
        let checkoutUrl = /*[[${productDetail.checkouturl}]]*/ '';

        if (!checkoutUrl) {
            $popup.alert("자료가 존재하지 않습니다.");
        } else { // checkoutUrl 맨 뒤에 CheckNo 값이 null인 경우
            let CheckNoNull = checkoutUrl.charAt(checkoutUrl.length - 1) == "=" ? true : false;

            if(CheckNoNull){
                $popup.alert("자료가 존재하지 않습니다.");
            }else{
                const inspectionPopup = window.open(checkoutUrl, '_blank');
                inspectionPopup.document.write(`
                <html lang="kr">
                <head>
                    <title>성능점검 기록부</title>
                    <style>
                    iframe{
                        display: block;
                        width: 100%;
                        height: calc(100vh - 5vh); /* 버튼 높이를 제외한 전체 */
                        border: none;
                     }
                    .close-btn {
                        font-size: 1.5vh;
                        background-color: #B82927;
                        font-width: bold;
                        color: white;
                        border: none;
                        height: 5vh;
                        text-align: center;
                        display: block;
                        width: 100%;
                        position: fixed;
                        bottom: 0;
                        left: 0;
                        cursor: pointer;
                    }
                    </style>
                </head>
                <body>
                    <iframe src="${checkoutUrl}" width="100%"></iframe>
                    <button class="close-btn" onclick="window.close()">닫기</button>
                </body>
                </html>
            `);
            }
        }
    };

    // 앱 > 레이어 팝업 뒤로 가기 적용
    function handleBackNavigation() {
        if (document.getElementById('totalCostPopup').classList.contains('on')) {
            $popup.close();
        }

        if (document.getElementById('calculatorPopup').classList.contains('on')) {
            $popup.close();
        }
    }

    function openPopup() {
        const url = 'https://ck.carmodoo.com/carCheck/carmodooPrint.do?print=0&checkNum=8500001378'; // 지정된 URL

        const popup = document.getElementById('inspectionPopup');
        const inspectionWrap = popup.querySelector('.inspection-wrap');

        const iframe = document.createElement('iframe');
        iframe.src = url;
        iframe.width = '100%';
        iframe.height = '500px';

        inspectionWrap.innerHTML = '';
        inspectionWrap.appendChild(iframe);

        // 팝업 표시
        popup.style.display = 'block';
    }

    // 팝업 닫기 함수
    function closePopup() {
        const popup = document.getElementById('inspectionPopup');
        popup.style.display = 'none';
    }

    //서브 페이지 제목
    var hdNm = /*[[ ${productDetail.carPlateNumber} ]]*/'';

    function specPopup(_this) {
        let detailGradeNumber = _this.getAttribute("data-detailGradeNumber");

        fetch("/api/search/product/spec/list", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({"productDetailGradeNumber": detailGradeNumber})
        })
            .then(res => res.json())
            .then(result => {
                if (result.code === 200) {
                    console.log(result)
                    let specListHtml = '';

                    result.data.forEach(spec => {
                        specListHtml += `<div class="cont"><h3 class="tit">${spec.specCtgry}</h3>`;
                        spec.specList.filter(specDetail => specDetail.specValue !== '' && specDetail.specValue !== '0' && specDetail.specValue !== '0.0')
                            .forEach(specDetail => {
                                specListHtml += `
                                    <dl>
                                        <dt>${specDetail.specNm}</dt>
                                        <dd>${specDetail.specValue} ${specDetail.specUom || ''}</dd>
                                    </dl>`;
                            });
                        specListHtml += `</div>`;
                    });

                    // specListTag에 생성한 HTML을 삽입
                    document.getElementById("specListTag").innerHTML = specListHtml;

                    // 팝업을 띄우는 함수 호출
                    $popup.template('#specificationPopup');
                }
            })
            .catch(error => {
                console.error('Error fetching specification data:', error);
            });
    }

    document.addEventListener('DOMContentLoaded', () => {
        const dateElement = document.getElementById('date-display');
        const dateStr = dateElement.getAttribute('data-date');
        if (dateStr) {
            const year = dateStr.substring(0, 4);
            const month = dateStr.substring(4, 6);
            const day = dateStr.substring(6, 8);
            dateElement.textContent = `${year}-${month}-${day}`;
        } else {
            dateElement.textContent = ''; // 날짜가 없는 경우 빈 문자열
        }

        const firstDateElement = document.getElementById('first-date-display');
        const firstDateStr = firstDateElement.getAttribute('data-date');
        if (firstDateStr) {
            const year = firstDateStr.substring(0, 4);
            const month = firstDateStr.substring(4, 6);
            const day = firstDateStr.substring(6, 8);
            firstDateElement.textContent = `${year}-${month}-${day}`;
        } else {
            firstDateElement.textContent = ''; // 날짜가 없는 경우 빈 문자열
        }

        // 차량 상세 옵션 아이콘 class on 처리
        let dbOptionList = document.querySelectorAll(".option-list.popup li");
        let filteredOptions = Array.from(dbOptionList).filter(li => li.classList.contains('on'));
        let linkOptionList = ["스마트 키", "버튼 시동 스마트키", "열선시트", "앞좌석 열선 시트", "뒷좌석 열선 시트", "통풍시트", "앞좌석 통풍 시트", "선루프", "내비게이션", "후방카메라", "크루즈 컨트롤", "블루투스", "블루투스 핸즈프리", "네비게이션"];

        // 열선시트와 통풍시트 및 스마트 키와 네비게이션의 특별 처리를 위한 플래그
        let hasSeatHeater = false;
        let hasVentilationSeat = false;
        let hasBluetooth = false;

        filteredOptions.forEach(function (item) {
            let optionText = item.textContent.trim().toLowerCase(); // 소문자로 변환

            // 각 옵션에 대해 linkOptionList와 비교
            linkOptionList.forEach(function (option) {
                // 옵션이 일치하는 경우
                if (optionText.includes(option.toLowerCase())) {
                    document.querySelectorAll(".optionIcon").forEach(function (icon) {
                        let optionName = icon.getAttribute('data-optionName').toLowerCase(); // 소문자로 변환

                        // 일반 옵션 매칭
                        if (optionText.includes(optionName)) {
                            icon.classList.add('on');
                        }

                        // "버튼 시동 스마트키"가 있으면 "스마트 키"에도 on 추가
                        if (option.includes('버튼 시동 스마트키'.toLowerCase()) && optionName === '스마트 키'.toLowerCase()) {
                            icon.classList.add('on');
                        }

                        // "앞좌석 열선 시트", "뒷좌석 열선 시트"가 있으면 "열선시트"에도 on 추가
                        if ((option.includes('앞좌석 열선 시트'.toLowerCase()) || option.includes('뒷좌석 열선 시트'.toLowerCase())) && optionName === '열선시트'.toLowerCase()) {
                            hasSeatHeater = true;
                            icon.classList.add('on');
                        }

                        // "통풍 시트" 또는 "앞좌석 통풍 시트"가 있으면 "통풍시트"에도 on 추가
                        if ((option.includes('앞좌석 통풍 시트'.toLowerCase()) || option.includes('통풍 시트'.toLowerCase())) && optionName === '통풍시트'.toLowerCase()) {
                            hasVentilationSeat = true;
                            icon.classList.add('on');
                        }

                        // "네비게이션" 또는 "내비게이션"이 있으면 매칭된 것에 on 추가
                        if ((option.includes('네비게이션'.toLowerCase()) || option.includes('내비게이션'.toLowerCase())) && (optionName === '네비게이션'.toLowerCase() || optionName === '내비게이션'.toLowerCase())) {
                            icon.classList.add('on');
                        }

                        // "블루투스 핸즈프리" 또는 "블루투스"가 있으면 "블루투스"에도 on 추가
                        if ((option.includes('블루투스 핸즈프리'.toLowerCase()) || option.includes('블루투스'.toLowerCase())) && optionName === '블루투스'.toLowerCase()) {
                            hasBluetooth = true;
                            icon.classList.add('on');
                        }
                    });
                }
            });
        });

        // 만약 열선 시트가 있는 경우 "열선시트"에 on 추가
        if (hasSeatHeater) {
            document.querySelectorAll(".optionIcon").forEach(function (icon) {
                let optionName = icon.getAttribute('data-optionName').toLowerCase();
                if (optionName === '열선시트'.toLowerCase()) {
                    icon.classList.add('on');
                }
            });
        }

        // 만약 통풍 시트가 있는 경우 "통풍시트"에 on 추가
        if (hasVentilationSeat) {
            document.querySelectorAll(".optionIcon").forEach(function (icon) {
                let optionName = icon.getAttribute('data-optionName').toLowerCase();
                if (optionName === '통풍시트'.toLowerCase()) {
                    icon.classList.add('on');
                }
            });
        }

        // 만약 블루투스가 있는 경우 "블루투스"에 on 추가
        if (hasBluetooth) {
            document.querySelectorAll(".optionIcon").forEach(function (icon) {
                let optionName = icon.getAttribute('data-optionName').toLowerCase();
                if (optionName === '블루투스'.toLowerCase()) {
                    icon.classList.add('on');
                }
            });
        }



    document.getElementById("searchCarHistoryMobile").onclick = async () => {
            let formData = new FormData(document.getElementById("carForm"));

            try {
                const response = await fetch('/api/search/carhistory', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.code === 200) {
                    let carPlatNumber = /*[[${productDetail.carPlateNumber}]]*/'';
                    console.log("carPlatNumber : " + carPlatNumber)

                    let useTypList = result.info.r202List;

                    useTypList.forEach(item => {
                        let code;
                        switch (item['r202-05']) {
                            case 1:
                                code = '관용';
                                break;
                            case 2:
                                code = '자가용';
                                break;
                            case 3:
                                code = '영업용';
                                break;
                            default:
                                code = '개인택시';
                                break;
                        }

                        // 날짜 변환
                        let date = item[0]?.['r202-02']; // Optional chaining
                        if (date) {
                            let formattedDate = `${date.substring(0, 4)}-${date.substring(4, 6)}-${date.substring(6, 8)}`;


                            let html = `
                    <div class="table">
                        <span class="date">${formattedDate}</span>
                        <dl>
                            <dt>소유자 변경</dt>
                            <dd>${item.ownerChange ?? '정보 없음'}</dd>
                        </dl>
                        <dl>
                            <dt>차량용도</dt>
                            <dd>${code}</dd>
                        </dl>
                    </div>`;
                            document.getElementById("useTypTag").innerHTML = html;
                        }
                    });

                    let carDistanceList = result.info.r602List;

                    if (carDistanceList.length) {
                        let totalDistance = carDistanceList.reduce((sum, tt) => {
                            return sum + (parseFloat(tt[1]?.['r602-03']?.replace(/,/g, '')) || 0);
                        }, 0);
                        totalDistance = totalDistance.toLocaleString(); // 주행거리 콤마 추가

                        carDistanceList.sort((a, b) => new Date(b[0]?.['r602-01']) - new Date(a[0]?.['r602-01']));
                        let recentDate = carDistanceList[0]?.[0]?.['r602-01'];
                        let formattedRecentDate = recentDate ? `${recentDate.substring(0, 4)}-${recentDate.substring(4, 6)}-${recentDate.substring(6, 8)}` : '정보 없음';

                        document.getElementById("carTotalDistance").innerText = `주행거리 : ${totalDistance} Km / 기록일자 : ${formattedRecentDate}`;
                        document.getElementById('carDistanceTag').innerHTML = '';

                        carDistanceList.forEach(tt => {
                            let date = tt[0]?.['r602-01'];
                            let formattedDate = date ? `${date.substring(0, 4)}-${date.substring(4, 6)}-${date.substring(6, 8)}` : '정보 없음';

                            let html = `
                                <tr>
                                    <td>${formattedDate}</td>
                                    <td>${parseFloat(tt[1]?.['r602-03'] || 0).toLocaleString()} km</td>
                                    <td>${tt[2]?.['r602-02'] || '정보 없음'}</td>
                                </tr>`;
                            document.getElementById("carDistanceTag").innerHTML += html;
                        });
                    } else {
                        document.getElementById("carDistanceTag").innerHTML = '<tr><td colspan="3">주행거리 정보 없음</td></tr>';
                    }

                    let myCarDamageList = result.info.r502List;
                    if (myCarDamageList.length) {
                        document.getElementById("myCarDamageList").innerHTML = '';

                        let html = '';

                        myCarDamageList.forEach(item => {
                            // 날짜를 yyyy-MM-dd 형식으로 변환 (문자열로 처리)
                            let dateString = item[1]?.['r502-02'];
                            let formattedDate = '';

                            if (dateString) {
                                // 날짜 형식이 이미 yyyy-MM-dd일 경우
                                if (dateString.includes('-')) {
                                    formattedDate = dateString;
                                } else if (dateString.length === 8) {
                                    // yyyymmdd 형식이라면
                                    const year = dateString.substring(0, 4);
                                    const month = dateString.substring(4, 6);
                                    const day = dateString.substring(6, 8);
                                    formattedDate = `${year}-${month}-${day}`;
                                } else {
                                    // 알 수 없는 형식일 경우 기본 값 설정
                                    formattedDate = 'Invalid Date';
                                }
                            } else {
                                // 날짜 값이 없을 경우 기본 값을 사용
                                formattedDate = 'N/A';
                            }

                            // 숫자에 콤마 추가
                            let estimateCost = item[2]?.['r502-03'] ? item[2]['r502-03'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';
                            let partsCost = item[5]?.['r502-06'] ? item[5]['r502-06'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';
                            let laborCost = item[6]?.['r502-07'] ? item[6]['r502-07'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';
                            let paintCost = item[7]?.['r502-08'] ? item[7]['r502-08'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';

                            // HTML 템플릿
                            let html = `
                                <p class="date">${formattedDate}</p>
                                <table>
                                    <caption></caption>
                                    <colgroup>
                                        <col>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <td rowspan="2"><strong>내차 사고 (피해)</strong></td>
                                        <td>
                                            <div>내 차 보험 (처리)</div>
                                        </td>
                                        <td>
                                            <div class="estimate-txt">
                                                <p class="txt">수리(견적)비용</p>
                                                <p class="c-primary">${estimateCost}원</p>
                                                <p class="txt">부품: ${partsCost}원</p>
                                                <p class="txt">공임 : ${laborCost}원</p>
                                                <p class="txt">도장 : ${paintCost}원</p>
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            `;

                            document.getElementById("myCarDamageList").innerHTML += html;
                        });

                    } else {
                        document.getElementById("myCarDamageList").innerHTML = '<p>사고 정보 없음</p>';
                    }

                    document.getElementById("myCarDamageCarNum").innerText = carPlatNumber;

                    // 금액 콤마 추가
                    let selfDamageInsuranceSum = parseFloat(result.data.selfDamageInsuranceSum).toLocaleString();
                    let otherCarDamageInsuranceSum = parseFloat(result.data.otherCarDamageInsuranceSum).toLocaleString();

                    // firstInsuranceDate 날짜 변환
                    let firstInsuranceDate = result.data.firstInsuranceDate;
                    let formattedFirstInsuranceDate = firstInsuranceDate ? `${firstInsuranceDate.substring(0, 4)}-${firstInsuranceDate.substring(4, 6)}-${firstInsuranceDate.substring(6, 8)}` : '정보 없음';
                    let standardDate = result.data.standardDate;
                    let formattedStandardDate = standardDate ? `${standardDate.substring(0, 4)}-${standardDate.substring(4, 6)}-${standardDate.substring(6, 8)}` : '정보 없음';

                    document.getElementById("carName").textContent = result.data.carNameDetail ?? '정보 없음';
                    document.getElementById("standardDate").textContent = `정보조회일: ${formattedStandardDate}`;
                    document.getElementById("selfDamage").textContent = result.data.selfDamageAccidentCount === 0 ? '없음' : `${result.data.selfDamageAccidentCount}회 (${selfDamageInsuranceSum}원)`;
                    document.getElementById("otherDamage").textContent = result.data.otherCarDamageAccidentCount === 0 ? '없음' : `${result.data.otherCarDamageAccidentCount}회 (${otherCarDamageInsuranceSum}원)`;
                    document.getElementById("ownerChange").textContent = result.data.ownerChangeCount === 0 ? '없음' : `${result.data.ownerChangeCount}회`;
                    document.getElementById("carInfoName").textContent = result.data.carName ?? '정보 없음';
                    document.getElementById("carNameDetail").textContent = result.data.carNameDetail ?? '정보 없음';
                    document.getElementById("carYear").textContent = result.data.carYear ?? '정보 없음';
                    document.getElementById("carFuel").textContent = result.data.fuelType ?? '정보 없음';
                    document.getElementById("carDisplacement").textContent = (result.data.carDisplacement ?? '정보 없음') + 'cc';
                    document.getElementById("firstInsuranceDate").textContent = formattedFirstInsuranceDate;
                    document.getElementById("rentalUseHistory").textContent = result.data.rentalUseHistory === "Y" ? '있음' : '없음';
                    document.getElementById("businessUseHistory").textContent = result.data.businessUseHistory === "Y" ? '있음' : '없음';
                    document.getElementById("personalUseHistory").textContent = result.data.personalUseHistory === "Y" ? '있음' : '없음';
                    document.getElementById("changeCarType").textContent = result.data.ownerChangeType === "" ? '없음' : '있음';
                    document.getElementById("totalLossCountMain").textContent = result.data.floodLossCount !== "0" ? '있음' : '없음';
                    document.getElementById("theftLossCountMain").textContent = result.data.theftLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("floodLossCountMain").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("totalLossCount").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("theftLossCount").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("floodLossCount").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    let data = result.data.noJoinDate;
                    let formattedData = data ? data.split(',').join('\n') : '정보 없음';
                    document.getElementById("noJoinDate").innerText = formattedData;

                    // 팝업 열기
                    $popup.template('#insurancePopup');
                } else if (result.code === 401) {
                    $popup.alert(result.message, {
                        confirm: () => {
                            location.href = result.data;
                        },
                        close: () => {
                            location.href = result.data;
                        }
                    });
                } else {
                    console.log(result);
                    $popup.alert(result.message);
                    return false;
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }
        // });

        document.getElementById("searchCarHistory").onclick = async () => {
            let formData = new FormData(document.getElementById("carForm"));
// 현재 URL 경로를 가져옴
            let path = window.location.pathname;
            console.log(path); // 출력: "/join/sns"
            formData.append("redirectUrl", path);
            try {
                const response = await fetch('/api/search/carhistory', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.code === 200) {
                    let carPlatNumber = /*[[${productDetail.carPlateNumber}]]*/'';
                    console.log("carPlate Number : " + carPlatNumber)
                    let useTypList = result.info.r202List;

                    useTypList.forEach(item => {
                        let code;
                        switch (item['r202-05']) {
                            case 1:
                                code = '관용';
                                break;
                            case 2:
                                code = '자가용';
                                break;
                            case 3:
                                code = '영업용';
                                break;
                            default:
                                code = '개인택시';
                                break;
                        }

                        // 날짜 변환
                        let date = item[0]?.['r202-02']; // Optional chaining
                        if (date) {
                            let formattedDate = `${date.substring(0, 4)}-${date.substring(4, 6)}-${date.substring(6, 8)}`;

                            let html = `
                    <div class="table">
                        <span class="date">${formattedDate}</span>
                        <dl>
                            <dt>소유자 변경</dt>
                            <dd>${item.ownerChange ?? '정보 없음'}</dd>
                        </dl>
                        <dl>
                            <dt>차량용도</dt>
                            <dd>${code}</dd>
                        </dl>
                    </div>`;
                            document.getElementById("useTypTag").innerHTML = html;
                        }
                    });

                    let carDistanceList = result.info.r602List;

                    if (carDistanceList.length) {
                        let totalDistance = carDistanceList.reduce((sum, tt) => {
                            return sum + (parseFloat(tt[1]?.['r602-03']?.replace(/,/g, '')) || 0);
                        }, 0);
                        totalDistance = totalDistance.toLocaleString(); // 주행거리 콤마 추가

                        carDistanceList.sort((a, b) => new Date(b[0]?.['r602-01']) - new Date(a[0]?.['r602-01']));
                        let recentDate = carDistanceList[0]?.[0]?.['r602-01'];
                        let formattedRecentDate = recentDate ? `${recentDate.substring(0, 4)}-${recentDate.substring(4, 6)}-${recentDate.substring(6, 8)}` : '정보 없음';

                        document.getElementById("carTotalDistance").innerText = `주행거리 : ${totalDistance} Km / 기록일자 : ${formattedRecentDate}`;
                        document.getElementById('carDistanceTag').innerHTML = '';

                        carDistanceList.forEach(tt => {
                            let date = tt[0]?.['r602-01'];
                            let formattedDate = date ? `${date.substring(0, 4)}-${date.substring(4, 6)}-${date.substring(6, 8)}` : '정보 없음';

                            let html = `
                                <tr>
                                    <td>${formattedDate}</td>
                                    <td>${parseFloat(tt[1]?.['r602-03'] || 0).toLocaleString()} km</td>
                                    <td>${tt[2]?.['r602-02'] || '정보 없음'}</td>
                                </tr>`;
                            document.getElementById("carDistanceTag").innerHTML += html;
                        });
                    } else {
                        document.getElementById("carDistanceTag").innerHTML = '<tr><td colspan="3">주행거리 정보 없음</td></tr>';
                    }

                    let myCarDamageList = result.info.r502List;
                    if (myCarDamageList.length) {
                        document.getElementById("myCarDamageList").innerHTML = '';

                        let html = '';

                        myCarDamageList.forEach(item => {
                            // 날짜를 yyyy-MM-dd 형식으로 변환 (문자열로 처리)
                            let dateString = item[1]?.['r502-02'];
                            let formattedDate = '';

                            if (dateString) {
                                // 날짜 형식이 이미 yyyy-MM-dd일 경우
                                if (dateString.includes('-')) {
                                    formattedDate = dateString;
                                } else if (dateString.length === 8) {
                                    // yyyymmdd 형식이라면
                                    const year = dateString.substring(0, 4);
                                    const month = dateString.substring(4, 6);
                                    const day = dateString.substring(6, 8);
                                    formattedDate = `${year}-${month}-${day}`;
                                } else {
                                    // 알 수 없는 형식일 경우 기본 값 설정
                                    formattedDate = 'Invalid Date';
                                }
                            } else {
                                // 날짜 값이 없을 경우 기본 값을 사용
                                formattedDate = 'N/A';
                            }

                            // 숫자에 콤마 추가
                            let estimateCost = item[2]?.['r502-03'] ? item[2]['r502-03'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';
                            let partsCost = item[5]?.['r502-06'] ? item[5]['r502-06'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';
                            let laborCost = item[6]?.['r502-07'] ? item[6]['r502-07'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';
                            let paintCost = item[7]?.['r502-08'] ? item[7]['r502-08'].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') : '0';

                            // HTML 템플릿
                            let html = `
                                <p class="date">${formattedDate}</p>
                                <table>
                                    <caption></caption>
                                    <colgroup>
                                        <col>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <tbody>
                                    <tr>
                                        <td rowspan="2"><strong>내차 사고 (피해)</strong></td>
                                        <td>
                                            <div>내 차 보험 (처리)</div>
                                        </td>
                                        <td>
                                            <div class="estimate-txt">
                                                <p class="txt">수리(견적)비용</p>
                                                <p class="c-primary">${estimateCost}원</p>
                                                <p class="txt">부품: ${partsCost}원</p>
                                                <p class="txt">공임 : ${laborCost}원</p>
                                                <p class="txt">도장 : ${paintCost}원</p>
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            `;

                            document.getElementById("myCarDamageList").innerHTML += html;
                        });


                        // document.getElementById("carDamageList").innerHTML = `<table>${html}</table>`;
                    } else {
                        document.getElementById("myCarDamageList").innerHTML = '<p>사고 정보 없음</p>';
                    }

                    const element = document.getElementById("myCarDamageCarNum");

                    if (element) {
                        element.textContent = carPlatNumber;
                    }
                    // 금액 콤마 추가
                    let selfDamageInsuranceSum = parseFloat(result.data.selfDamageInsuranceSum).toLocaleString();
                    let otherCarDamageInsuranceSum = parseFloat(result.data.otherCarDamageInsuranceSum).toLocaleString();

                    // firstInsuranceDate 날짜 변환
                    let firstInsuranceDate = result.data.firstInsuranceDate;
                    let formattedFirstInsuranceDate = firstInsuranceDate ? `${firstInsuranceDate.substring(0, 4)}-${firstInsuranceDate.substring(4, 6)}-${firstInsuranceDate.substring(6, 8)}` : '정보 없음';
                    let standardDate = result.data.standardDate;
                    let formattedStandardDate = standardDate ? `${standardDate.substring(0, 4)}-${standardDate.substring(4, 6)}-${standardDate.substring(6, 8)}` : '정보 없음';

                    document.getElementById("carName").textContent = result.data.carNameDetail ?? '정보 없음';
                    document.getElementById("standardDate").textContent = `정보조회일: ${formattedStandardDate}`;
                    document.getElementById("selfDamage").textContent = result.data.selfDamageAccidentCount === 0 ? '없음' : `${result.data.selfDamageAccidentCount}회 (${selfDamageInsuranceSum}원)`;
                    document.getElementById("otherDamage").textContent = result.data.otherCarDamageAccidentCount === 0 ? '없음' : `${result.data.otherCarDamageAccidentCount}회 (${otherCarDamageInsuranceSum}원)`;
                    document.getElementById("ownerChange").textContent = result.data.ownerChangeCount === 0 ? '없음' : `${result.data.ownerChangeCount}회`;
                    document.getElementById("carInfoName").textContent = result.data.carName ?? '정보 없음';
                    document.getElementById("carNameDetail").textContent = result.data.carNameDetail ?? '정보 없음';
                    document.getElementById("carYear").textContent = result.data.carYear ?? '정보 없음';
                    document.getElementById("carFuel").textContent = result.data.fuelType ?? '정보 없음';
                    document.getElementById("carDisplacement").textContent = (result.data.carDisplacement ?? '정보 없음') + 'cc';
                    document.getElementById("firstInsuranceDate").textContent = formattedFirstInsuranceDate;
                    document.getElementById("rentalUseHistory").textContent = result.data.rentalUseHistory === "Y" ? '있음' : '없음';
                    document.getElementById("businessUseHistory").textContent = result.data.businessUseHistory === "Y" ? '있음' : '없음';
                    document.getElementById("personalUseHistory").textContent = result.data.personalUseHistory === "Y" ? '있음' : '없음';
                    document.getElementById("changeCarType").textContent = result.data.ownerChangeType === "" ? '없음' : '있음';
                    document.getElementById("totalLossCountMain").textContent = result.data.floodLossCount !== "0" ? '있음' : '없음';
                    document.getElementById("theftLossCountMain").textContent = result.data.theftLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("floodLossCountMain").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("totalLossCount").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("theftLossCount").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    document.getElementById("floodLossCount").textContent = result.data.floodLossCount !== "0" ? "있음" : "없음";
                    let data = result.data.noJoinDate;
                    let formattedData = data ? data.split(',').join('\n') : '정보 없음';
                    document.getElementById("noJoinDate").innerText = formattedData;

                    // 팝업 열기
                    $popup.template('#insurancePopup');
                } else if (result.code === 401) {
                    $popup.alert(result.message, {
                        confirm: () => {
                            location.href = result.data;
                        },
                        close: () => {
                            location.href = result.data;
                        }
                    });
                } else {
                    console.log(result);
                    $popup.alert(result.message);
                    return false;
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        const today = new Date();

        // 현재 시간으로 설정 start
        const currentHour = today.getHours();
        const currentMinute = today.getMinutes();
        const hourOptions = document.querySelector('select[name="hour"]').options;
        const minuteOptions = document.querySelector('select[name="minute"]').options;

        for (let i = 0; i < hourOptions.length; i++) {
            if (parseInt(hourOptions[i].value) === currentHour) {
                hourOptions[i].selected = true;
                break;
            }
        }

        for (let i = 0; i < minuteOptions.length; i++) {
            if (parseInt(minuteOptions[i].value) === currentMinute) {
                minuteOptions[i].selected = true;
                break;
            }
        }
        // 현재 시간으로 설정 end

        // 달력 설정 start
        const monthElement = document.querySelector('.clndr .month');
        const tbody = document.querySelector('.clndr .tbody');
        const prevButton = document.querySelector('.clndr-previous-button');
        const nextButton = document.querySelector('.clndr-next-button');

        let currentYear = new Date().getFullYear();
        let currentMonth = new Date().getMonth();

        // 좌우 버튼 활성화
        function updateButtons() {
            nextButton.parentElement.classList.add('on');

            // 현재 날이면 이전 버튼 비활성화
            if (currentYear === today.getFullYear() && currentMonth === today.getMonth()) {
                prevButton.disabled = true;
                prevButton.parentElement.classList.remove('on');
            } else {
                prevButton.disabled = false;
                prevButton.parentElement.classList.add('on');
            }
        }

        // 달력 그리기
        function makeCalendar(year, month) {
            tbody.innerHTML = ''; // 이전 날짜 초기화

            const firstDay = new Date(year, month).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            // 년월 표기
            monthElement.textContent = `${year}.${String(month + 1).padStart(2, '0')}`;

            // 빈 공간 그리기
            for (let i = 0; i < firstDay; i++) {
                const emptyDiv = document.createElement('div');
                emptyDiv.classList.add('day');
                const emptyButton = document.createElement('button');
                emptyButton.type = 'button';
                emptyButton.innerHTML = '<em class="day-contents"></em>';

                emptyDiv.appendChild(emptyButton);
                tbody.appendChild(emptyDiv);
            }

            // 날짜 그리기
            for (let i = 1; i <= daysInMonth; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.classList.add('day');
                const dayButton = document.createElement('button');
                dayButton.type = 'button';
                dayButton.innerHTML = `<em class="day-contents">${i}</em>`;

                // 오늘 날짜에 클래스 추가
                if (year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {
                    dayDiv.classList.add('today');
                }

                dayDiv.appendChild(dayButton);
                tbody.appendChild(dayDiv);
            }

            // 날짜 클릭
            document.querySelectorAll('.day').forEach(day => {
                const dayNumber = parseInt(day.querySelector('.day-contents').textContent); // 클릭한 날짜
                const clickedDate = new Date(year, month, dayNumber);

                // 오늘 이전 날짜에 disabled 클래스 추가
                if (clickedDate < today.setHours(0, 0, 0, 0)) {
                    day.classList.add('disabled');
                }

                day.addEventListener('click', () => {
                    const isToday = year === today.getFullYear() && month === today.getMonth() && dayNumber === today.getDate(); // 클릭한 날짜가 오늘인지

                    if (clickedDate < today.setHours(0, 0, 0, 0)) {
                        return;
                    }

                    // 오늘이 아니면 클래스 추가
                    // if (!isToday) {
                    document.querySelectorAll('.day').forEach(d => d.classList.remove('selectday'));
                    day.classList.add('selectday');
                    // }
                });
            });

            updateButtons();
        }

        // 이전 버튼
        prevButton.addEventListener('click', () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            makeCalendar(currentYear, currentMonth);
        });

        // 다음 버튼
        nextButton.addEventListener('click', () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            makeCalendar(currentYear, currentMonth);
        });

        makeCalendar(currentYear, currentMonth);

        // 달력 설정 end
    });

    const realName = document.getElementById('realName');
    const mobileNumber = document.getElementById('mobileNumber');
    const authNumber = document.getElementById('authNumber');
    let authBool = false;

    function sendAuthNumber() {
        if (realName.value.trim().length < 1) {
            $popup.alert('성함을 입력해주세요.');
            isValid = false;
            return;
        } else {
            isValid = true;
        }

        if (mobileNumber.value.trim().length < 1) {
            $popup.alert('전화번호를 입력해주세요.');
            isValid = false;
            return;
        } else {
            isValid = true;
        }

        fetch("/api/join/check/phone", {
            method: "POST",
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                phoneNumber: mobileNumber.value,
                type: "CR004"
            })
        })
            .then(res => res.json())
            .then(result => {
                if (result.code === 200) {
                    document.getElementById("sendAuthNumberBtn").textContent = '재전송';
                    document.getElementById("authNumber").classList.remove("is-disabled");
                    $popup.alert("인증번호가 발송되었습니다.");
                }
            })
    }

    function checkNumber() {
        if (authNumber.value.trim().length < 1) {
            $popup.alert('인증번호를 입력해주세요.');
            isValid = false;
            return;
        } else {
            isValid = true;
        }

        fetch("/api/join/number/check", {
            method: "POST",
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                numberCheck: authNumber.value,
                phoneNumber: mobileNumber.value
            })
        })
            .then(res => res.json())
            .then(result => {
                if (result.code === 200) {
                    authBool = true;
                    $popup.alert(result.message);
                } else {
                    $popup.alert(result.message)
                }
            })
    }

    // 방문 예약
    async function booking() {
        let isNotMember = await isMember(); // true = 비회원

        let commonValidation = await validCommonForm(); // 날짜 선택 검사
        if(commonValidation){ // false라면 규칙을 잘 지켰다는 뜻
            return;
        }

        let notMemberValidation = await validNotMemberForm();
        if(notMemberValidation){ // false라면 규칙을 잘 지켰다는 뜻
            return;
        }

        if (isValid) {
            if(!isNotMember){ // 회원만 들어가는 함수
                let isMarketingAgree = await checkMarketAgreement(); // 마케팅 동의 확인 함수

                if(isMarketingAgree){
                    return;
                }
            }
            // 문제 없다면 바로 방문 예약 실행
            await applyBooking();
        }
    }

    /*
    * 비회원 확인 유무
    */
    async function isMember(){
        let isMember = document.querySelector("input[type='checkbox'][id='terms01']"); // [필수] 개인정보 수집 이용.동의 체크 유무 확인
        let isTrue = false;

        if(isMember != null){ // 비회원
            isTrue = isMember.checked;
        }

        return isTrue;
    }

    /*
    * 방문예약 fetch문
    */
    async function applyBooking(){
        const formData = new FormData();

        // 비회원
        if (document.querySelector('.nonmember-wrap')) {
            formData.append('realName', document.getElementById('realName').value);
            formData.append('mobileNumber', document.getElementById('mobileNumber').value);
            formData.append('useYn', document.getElementById('terms01').value);
        }

        formData.append('calendar', document.querySelector('.month').textContent);
        formData.append('day', document.querySelector('.selectday').textContent);
        formData.append('hour', document.getElementById('hour').value);
        formData.append('minute', document.getElementById('minute').value);
        formData.append('productId', document.querySelector('input[name="productId"]').value);

        fetch('/purchase/inquiry/write', {
            method: 'POST',
            body: formData
        })
            .then(response => response.json())
            .then(result => {
                if (result.code !== 200) {
                    $popup.alert(result.message);
                } else {
                    $popup.close();
                    $popup.template('#completedPopup');
                    resetForm();
                }
            })
            .catch(error => {
                console.error(error);
                alert(error);
            });
    }

    /*
    * 마케팅 수신 정보 동의 여부 확인 함수
    */
    async function checkMarketAgreement(){
        let isTure = false;
        await fetch('/purchase/inquiry/checkAgree', {
            method: 'GET'
        })
            .then(response => response.json())
            .then(result => {
                if (result.code !== 200) {
                    $popup.template('#agreeMarketingPopup');
                    $popup.alert(result.message);
                    isTure = true;
                }
            })
            .catch(error => {
                console.error(error);
                alert(error);
                isTure = true;
            });
        return isTure;
    }

    /*
    * 공통 조건 확인 함수
    * */
    function validCommonForm(){

        if (!document.querySelector('.selectday')) {
            $popup.alert('상담 날짜를 선택해주세요.');
            isValid = false;
            return true;
        } else {
            isValid = true;
        }

        if (!document.getElementById('hour') || !document.getElementById('minute')) {
            $popup.alert('상담 시간을 선택해주세요.');
            isValid = false;
            return true;
        } else {
            isValid = true;
        }
        return false;
    }

    /*
    * 비회원 조건 확인 함수
    * */
    function validNotMemberForm(){
        if (document.querySelector('.nonmember-wrap')) {
            if (realName.value.trim().length < 1) {
                $popup.alert('성함을 입력해주세요.');
                isValid = false;
                return true;
            } else {
                isValid = true;
            }

            if (mobileNumber.value.trim().length < 1) {
                $popup.alert('전화번호를 입력해주세요.');
                isValid = false;
                return true;
            } else {
                isValid = true;
            }

            if (authBool == false) {
                $popup.alert('인증을 진행해 주세요.');
                isValid = false;
                return true;
            } else {
                isValid = true;
            }

            if (!document.getElementById('terms01').checked) {
                $popup.alert('개인정보 수집 이용.동의에 체크해주세요.');
                isValid = false;
                return true;
            } else {
                isValid = true;
            }

        }
        return false;
    }

    /*
    * 마케팅 수신 정보 동의 함수
    */
    function updateMarketingAgree(){

        if (!document.getElementById('agreeMarketingChk')) {
            $popup.alert('마케팅 수신 정보 동의해 주십시오.');
            return;
        }

        fetch('/purchase/inquiry/updateAgree', {
            method: 'POST'
        })
            .then(response => response.json())
            .then(result => {
                if (result.code !== 200) {
                    $popup.alert(result.message);
                    $popup.close();
                } else {
                    $popup.close();
                    applyBooking(); // 정상적으로 작동했을 경우 예약되도록 변경
                }
            })
            .catch(error => {
                console.error(error);
                alert(error);
            });
    }

    function resetForm() {
        // 날짜, 시간 초기화
        const selectedDay = document.querySelector('.selectday');
        if (selectedDay) {
            selectedDay.classList.remove('selectday'); // 선택된 날짜 초기화
        }

        const today = new Date();
        // 현재 시간으로 설정 start
        const currentHour = today.getHours();
        const currentMinute = today.getMinutes();
        const hourOptions = document.querySelector('select[name="hour"]').options;
        const minuteOptions = document.querySelector('select[name="minute"]').options;

        hourOptions[0].selected = true;
        for (let i = 0; i < hourOptions.length; i++) {
            if (parseInt(hourOptions[i].value) === currentHour) {
                hourOptions[i].selected = true;
                break;
            }
        }

        for (let i = 0; i < minuteOptions.length; i++) {
            if (parseInt(minuteOptions[i].value) === currentMinute) {
                minuteOptions[i].selected = true;
                break;
            }
        }
        // 현재 시간으로 설정 end

        // 비회원일 경우 입력 필드 초기화
        if (document.querySelector('.nonmember-wrap')) {
            document.getElementById('realName').value = '';
            document.getElementById('mobileNumber').value = '';
            document.getElementById('authNumber').value = ''; // 인증번호 초기화
            document.getElementById('terms01').checked = false; // 체크박스 초기화
            authBool = false;
        }
    }

    $(document).ready(function () {
        let afterServiceDate = /*[[${productDetail.afterServiceDate}]]*/ '';
        let frstRegistDe = /*[[${productDetail.frstRegistDe}]]*/ null;
        let formantRegistDe = null;
        if (frstRegistDe !== null) {
            formantRegistDe = frstRegistDe.replace(/(\d{4})(\d{2})(\d{2})/, '$1-$2-$3');
        }
        //
        // let afterServiceDateObj = new Date(afterServiceDate); // 보증기간 종료일
        // let formantRegistDeObj = formantRegistDe !== null ? new Date(formantRegistDe) : null; // 제조년월
        // let today2 = new Date(); // 현재
        //
        // let timeDifference = today2.getTime() - formantRegistDeObj.getTime();
        // let dayDifference = Math.round(timeDifference / (1000 * 3600 * 24));
        //
        // let afterServiceDays = (afterServiceDateObj.getTime() - formantRegistDeObj.getTime()) / (1000 * 3600 * 24);
        //
        // let asDaysLeft = afterServiceDays - dayDifference;
        // let asMonthsLeft = Math.floor(asDaysLeft / 30);
        // let remainingDays = asDaysLeft % 30;
        //
        // console.log(`${asMonthsLeft}개월 ${remainingDays}일`);
        //
        // let totalWarrantyDays = (afterServiceDateObj.getTime() - formantRegistDeObj.getTime()) / (1000 * 3600 * 24);
        // let warrantyUsedPercent = Math.round((dayDifference / totalWarrantyDays) * 100);
        //
        // let warrantyRemainingPercent = 100 - warrantyUsedPercent;
        //
        // if (asDaysLeft <= 0) {
        //     document.getElementById("asPercentText").innerText = "종료";
        //     document.getElementById("asPercentWidth").style.width = '100%';
        // } else {
        //     document.getElementById("asPercentText").innerText = asMonthsLeft + "개월 " + remainingDays + '일';
        //     document.getElementById("asPercentWidth").style.width = warrantyRemainingPercent + '%';
        // }
        //
        //
        function runAllGauges() {
            var gauges = $('.mileage-cont');
            $.each(gauges, function (i, v) {
                var self = this;
                setTimeout(function () {
                    setGauge(self);
                }, i * 700);
            });
        }


        function setGauge(gauge) {
            console.log("setGauge", gauge)
            // 제품 등록 연도와 사용된 킬로미터 가져오기
            let productRegYear = [[${yearDifference}]];
            let km = [[${productDetail.carUseKm}]];

            // 연간 주행 거리 계산
            let kmPerYear;
            if (productRegYear === 0) {
                kmPerYear = km; // productRegYear가 0일 경우, km 값을 그대로 사용
            } else {
                kmPerYear = km / productRegYear; // 그렇지 않은 경우 kmPerYear 계산
            }

            let ceilKmPerYear = Math.round(kmPerYear);
            document.getElementById("kmPerYear").innerText = ceilKmPerYear.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' km';


            // krKmPerYear 값을 숫자로 변환
            let krKmPerYear = document.getElementById("krKmPerYear").textContent.replace(/,/g, '');
            krKmPerYear = parseFloat(krKmPerYear);

            console.log("krKmPerYear", krKmPerYear)
            console.log("km", km)
            console.log("ceilKmPerYear", ceilKmPerYear)

            // 기준 주행 거리와 실제 주행 거리의 비율을 퍼센트로 계산
            let percentageOfCeilKmPerYear = (ceilKmPerYear / krKmPerYear) * 100;

            console.log("percentageOfCeilKmPerYear", percentageOfCeilKmPerYear)

            document.getElementById("percentId").setAttribute('data-percentage', percentageOfCeilKmPerYear);

            // 게이지의 회전 각도 설정
            // var percentage = gauge.getAttribute("data-percentage") / 100;
            // console.log("percentage", percentage)
            // percentId의 data-percentage 값에 따라 클래스 추가
            var percentId = document.getElementById("percentId");
            // var dataPercentage = parseFloat(percentId.getAttribute('data-percentage'));
            // console.log("dataPercentage",dataPercentage)
            let statusText = document.getElementById("statusText");
            var mileageElement = document.getElementById("mileageGauge");
            mileageElement.classList.remove("mileage1", "mileage2", "mileage3", "mileage4", "mileage5");
            // var degrees = 180 * dataPercentage;
            // console.log("degree",degrees)
            // var pointerDegrees = dataPercentage - 90;
            // console.log("pointerDegrees", pointerDegrees)
            var pointer = $(gauge).find('.pointer');

            if (percentageOfCeilKmPerYear >= 0 && percentageOfCeilKmPerYear < 50) {
                pointerDegrees = -70;
                mileageElement.classList.add("mileage1");
                statusText.innerText = "매우 짧음";
            } else if (percentageOfCeilKmPerYear >= 50 && percentageOfCeilKmPerYear < 80) {
                pointerDegrees = -40;
                mileageElement.classList.add("mileage2");
                statusText.innerText = "짧음";
            } else if (percentageOfCeilKmPerYear >= 80 && percentageOfCeilKmPerYear < 120) {
                pointerDegrees = 0;
                mileageElement.classList.add("mileage3");
                statusText.innerText = "보통";
            } else if (percentageOfCeilKmPerYear >= 120 && percentageOfCeilKmPerYear < 150) {
                pointerDegrees = 40;
                mileageElement.classList.add("mileage4");
                statusText.innerText = "많음";
            } else if (percentageOfCeilKmPerYear >= 150) {
                pointerDegrees = 70;
                mileageElement.classList.add("mileage5");
                statusText.innerText = "매우 많음";
            }

            $(pointer).attr({
                style: 'transform: rotate(' + pointerDegrees + 'deg)'
            });

            // percentId의 data-percentage 값에 따라 클래스 추가
            // var percentId = document.getElementById("percentId");
            // var dataPercentage = parseFloat(percentId.getAttribute('data-percentage')) / 2;
            // console.log("dataPercentage", dataPercentage)

            // 기준에 따라 클래스 및 텍스트 설정
            // if (dataPercentage > 120) {
            //     mileageElement.classList.add("mileage5");
            //     statusText.innerText = "매우 많음";
            // } else if (dataPercentage > 80) {
            //     mileageElement.classList.add("mileage4");
            //     statusText.innerText = "많음";
            // } else if (dataPercentage > 40) {
            //     mileageElement.classList.add("mileage3");
            //     statusText.innerText = "보통";
            // } else if (dataPercentage > 0) {
            //     mileageElement.classList.add("mileage2");
            //     statusText.innerText = "짧음";
            // } else {
            //     mileageElement.classList.add("mileage1");
            //     statusText.innerText = "매우 짧음";
            // }
        }


        function resetGauges() {
            var gauges = $('.mileage-cont');
            $.each(gauges, function (i, v) {
                var pointer = $(v).find('.pointer');
                $(pointer).css('transform', 'rotate(-90deg)');
            });
        }

        // Create a MutationObserver to watch for class changes
        var observer = new MutationObserver(function (mutations) {
            mutations.forEach(function (mutation) {
                if (mutation.attributeName === 'class') {
                    var classList = mutation.target.classList;
                    if (classList.contains('on')) {
                        runAllGauges();
                    } else {
                        resetGauges();
                    }
                }
            });
        });

        // Observe the popup element for attribute changes
        var popupElement = document.getElementById('mileagePopup');
        observer.observe(popupElement, {
            attributes: true // Monitor attribute changes
        });
    });

    $(window).scroll(function () {
        var height = $(document).scrollTop();
        // console.log(height); // Log the scroll position

        if (height >= 960) {
            $('.pw-bar-inner').css({
                '-webkit-animation-name': 'animationProgress',
                '-webkit-animation-duration': '3s',
                '-webkit-transition': '3s all'
            });
        }
    });

    //     클릭하면 숫자 바로 올라가게 하기

    $('#consult').click(function () {
        $('.middle').css('display', 'none');
        $('.middle2').css('display', 'block');
        $('.middle3').css('display', 'none');
        $('.middle4').css('display', 'none');
        $('.middle5').css('display', 'none');
        $('.middle6').css('display', 'none');
        $('.middle_lease').css('display', 'none');
        $('#budget').val($('#price').val());
        $('.btm').css('display', 'none');
    });
    $('#step2').click(function () {
        $('.middle').css('display', 'none');
        $('.middle2').css('display', 'none');
        $('.middle3').css('display', 'block');
        $('.middle4').css('display', 'none');
        $('.middle5').css('display', 'none');
        $('.middle6').css('display', 'none');
        $('.middle_lease').css('display', 'none');
        $('.btm').css('display', 'none');
    });
    $('#step3').click(function () {
        $('.middle').css('display', 'none');
        $('.middle2').css('display', 'none');
        $('.middle3').css('display', 'none');
        $('.middle4').css('display', 'block');
        $('.middle5').css('display', 'none');
        $('.middle6').css('display', 'none');
        $('.middle_lease').css('display', 'none');
        $('.btm').css('display', 'none');
    });
    $('#step4').click(function () {
        $('.middle').css('display', 'none');
        $('.middle2').css('display', 'none');
        $('.middle3').css('display', 'none');
        $('.middle4').css('display', 'none');
        $('.middle5').css('display', 'block');
        $('.middle6').css('display', 'none');
        $('.middle_lease').css('display', 'none');
        $('.btm').css('display', 'none');
    });
    $('#step5').click(function () {
        $('.middle').css('display', 'none');
        $('.middle2').css('display', 'none');
        $('.middle3').css('display', 'none');
        $('.middle4').css('display', 'none');
        $('.middle5').css('display', 'none');
        $('.middle6').css('display', 'block');
        $('.middle_lease').css('display', 'none');
        $('.btm').css('display', 'none');
    });
    $('#monthlyPlan, #monthlyPlan2').click(function () {
        $('.middle').css('display', 'block');
        $('.middle2').css('display', 'none');
        $('.middle3').css('display', 'none');
        $('.middle4').css('display', 'none');
        $('.middle5').css('display', 'none');
        $('.middle6').css('display', 'none');
        $('.middle_lease').css('display', 'none');
    });
    $('#leasePlan, #leasePlan2').click(function () {
        $('.middle').css('display', 'none');
        $('.middle2').css('display', 'none');
        $('.middle3').css('display', 'none');
        $('.middle4').css('display', 'none');
        $('.middle5').css('display', 'none');
        $('.middle6').css('display', 'none');
        $('.middle_lease').css('display', 'block');
    });

/**
 * 할부 월 납부금 계산
 * @param {String}  price   차량가격
 * @return {Boolean|null}
 * */
    function proceed(price) {

        if ($("#price").val() == '') {
            alert("차량가격을 입력해주세요");
            return false;
        } else if ($("#interest").val() == '') {
            alert("연 이율을 입력해 주세요");
            return false;
        } else {
            var ca = stripComma($("#price").val());
            var cb = stripComma($("#interest").val());
            var cc = stripComma($("#period").val());
            var cd = stripComma($("#upfront").val());

            var result = calculateEqualPrincipalAndInterest(ca, cb, cc, cd);

            $('#result').val(nformat(result));
        }
    }


    /**
     * 계산할 때는 콤마 제거하고 처리하기
     * @param {String}  str   가격
     * @return {String}
     * */
    function stripComma(str) {
        var re = /,/g;
        return str.replace(re, "");
    }

    /**
     * 결과 보여줄 때는 콤마 붙여서 표시하기
     * @param {String}  str   가격
     * @return {String}
     * */
    function nformat(str) {
        var reg = /(^[+-]?\d+)(\d{3})/;
        str = String(str);

        while (reg.test(str))
            str = str.replace(reg, '$1' + ',' + '$2');
        return str;
    }

    /**
     * 입력한 차량가격에 따라 선수금 비율을 반영한 수치를 표시해줌
     * @param {String}  a   선수금
     * */
    function calc_upfront(a) {
        $('#upfront').val(nformat(stripComma($('#price').val()) * a / 100));
    }

    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('upfront').value = Math.round(document.getElementById('price').value * 0.3);
    });


    /**
     * 원리금균등상환 공식에 따른 월납부금 구하기
     * @param {Number}  loanAmount            차량 가격(원)
     * @param {Number}  annualInterestRate    연 이율(%)
     * @param {Number}  loanPeriodInMonths    할부 기간(월 단위)
     * @param {Number}  upfront               선수금(원)
     * @returns {Number}                      월 납부금
     * */
    function calculateEqualPrincipalAndInterest(loanAmount, annualInterestRate, loanPeriodInMonths, upfront) {
        var monthlyInterestRate = annualInterestRate / 12 / 100;
        var monthlyPayment = (loanAmount - upfront) * monthlyInterestRate * Math.pow(1 + monthlyInterestRate, loanPeriodInMonths) / (Math.pow(1 + monthlyInterestRate, loanPeriodInMonths) - 1);
        monthlyPayment = Math.round(monthlyPayment);
        return monthlyPayment;
    }

    // 리스 비용 계산기. rate.js 를 사용함.
    function leaseCalculator() {
        if ($('#leaseTerm').val() == "") {
            alert('리스기간을 입력해주세요');
            return false;
        }
        if ($('#leasePayment').val() == "") {
            alert('월 납입금을 입력해주세요');
            return false;
        }
        if ($('#leasePrice').val() == "") {
            alert('취득원가를 입력해주세요');
            return false;
        }
        if ($('#leaseValue').val() == "") {
            alert('잔존가치를 입력해주세요');
            return false;
        }
        var leaseterm = parseInt(stripComma($('#leaseTerm').val()));
        var leasepayment = parseInt(stripComma($('#leasePayment').val()));
        var leaseprice = parseInt(stripComma($('#leasePrice').val()));
        var leasevalue = parseInt(stripComma($('#leaseValue').val()));
        var leaseupfront = parseInt(stripComma($('#leaseUpfront').val()));
        var totalinterest = leaseterm * leasepayment + leasevalue + leaseupfront - leaseprice;
        $('#leaseTotalinterest').val(nformat(totalinterest));
        var monthlyinterest = leaseterm === 0 ? 0 : Math.round(totalinterest / leaseterm)
        $('#leaseMonthlyinterest').val(nformat(monthlyinterest));
        var totalprice = leaseterm * leasepayment + leasevalue + leaseupfront;
        $('#leaseTotalprice').val(nformat(totalprice));
        var rate = RATE(leaseterm, leasepayment, -leaseprice + leaseupfront, leasevalue, 0, 0.0000001) * 1200;
        $('#leaseInterest').val(Math.round(rate * 100) / 100);
    }

    /**
     * 숫자 입력 시 3자리마다 comma 입력해주는 펑션들
     * @param {String}  _obj            차량 가격(원)
     * */
    function updateTextView(_obj) {
        var num = getNumber(_obj.val());
        if (num == 0) {
            _obj.val('0');
        } else {
            _obj.val(num.toLocaleString());
        }
    }

    function getNumber(_str) {
        var arr = _str.split('');
        var out = new Array();
        for (var cnt = 0; cnt < arr.length; cnt++) {
            if (isNaN(arr[cnt]) == false) {
                out.push(arr[cnt]);
            }
        }
        return Number(out.join(''));
    }

    $(document).ready(function () {
        $('input[type=text]').not('#interest, #realName, #mobileNumber, #authNumber').on('keyup', function () {
            updateTextView($(this));
        });
    });

    function check(salePrice) {
        $("#salePrice").val(stripComma(salePrice));//가격의 쉼표제거(,)
        $(".tablearea2").css("display", "block");

        var num0 = stripComma(salePrice);
        console.log("num0 ", num0)
        var num1 = 0;//등록세<img src="https://www.000webhost.com/static/default.000webhost.com/images/powered-by-000webhost.png" alt="www.000webhost.com">
        var num2 = 0;//취득세
        var num3 = 0;//공채매입비
        var num4 = 0;//증지대
        var num5 = 0;//인지대
        var num6 = 0;//등록퍼센트
        var num7 = 0;//취득퍼센트
        var num8 = 0;//알선수수료
        var num9 = 440000;//매도비용

        //공채매입비 계산
        if (!salePrice) {
            alert("차량판매가격을 입력해주세요");
            $(".tablearea2").css("display", "none");
            return false;
        } else if (checkNum(stripComma(salePrice)) == false) {
            alert("숫자만 입력해주세요");
            $(".tablearea2").css("display", "none");
            return false;
        } else if ($("[name=purpose]:checked").val() == 'category1' && $("[name=type1]").val() == '') {
            // console.log($("[name=purpose]:checked").val())
            // console.log($("[name=type1]").val())
            alert("차종을 선택해 주세요");
            $(".tablearea2").css("display", "none");
            return false;
        } else if ($("[name=purpose]:checked").val() == 'category2' && $("[name=type2]").val() == '') {
            alert("차종을 선택해 주세요");
            $(".tablearea2").css("display", "none");
            return false;
        } else if ($("[name=area]").val() == '') {
            alert("지역을 선택해 주세요");
            $(".tablearea2").css("display", "none");
            return false;
        } else if ($("[name=type1]").val() == '999') {
            num3 = 0;

        } else if ($("[name=purpose]:checked").val() == 'category1') {
            if ($("[name=type1]").val() == '1499') {
                if ($("[name=area]").val() == '서울') {
                    num3 = Math.floor((num0 * 10000 * 0.009)) * 10;
                } else if ($("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = Math.floor((num0 * 10000 * 0.004)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.006)) * 10;
                } else if ($("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }

            } else if ($("[name=type1]").val() == '1599') {
                if ($("[name=area]").val() == '서울') {
                    num3 = Math.floor((num0 * 10000 * 0.009)) * 10;
                } else if ($("[name=area]").val() == '부산' || $("[name=area]").val() == '대구' || $("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = Math.floor((num0 * 10000 * 0.004)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.006)) * 10;
                } else if ($("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                }
            } else if ($("[name=type1]").val() == '1999') {
                if ($("[name=area]").val() == '서울') {
                    num3 = Math.floor((num0 * 10000 * 0.012)) * 10;
                } else if ($("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = Math.floor((num0 * 10000 * 0.004)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.008)) * 10;
                } else if ($("[name=area]").val() == '제주' || $("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = Math.floor((num0 * 10000 * 0.004)) * 10;
                }
            } else if ($("[name=type1]").val() == '2000') {
                if ($("[name=area]").val() == '서울') {
                    num3 = Math.floor((num0 * 10000 * 0.020)) * 10;
                } else if ($("[name=area]").val() == '부산' || $("[name=area]").val() == '대구' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = Math.floor((num0 * 10000 * 0.005)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.012)) * 10;
                }
            } else if ($("[name=type1]").val() == '7') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '인천') {
                    num3 = 390000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종' || $("[name=area]").val() == '제주') {
                    alert("대전,울산,경기,강원,전북,전남,경북,충남,충북 지역의\n7~10인승 차량은 배기량 기준으로 책정됩니다.\n배기량을 선택해 주세요.");
                    $(".tablearea2").css("display", "none");
                    return false;
                }
            } else if ($("[name=type1]").val() == '11') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 390000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                }
            } else if ($("[name=type1]").val() == '16') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 650000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                }
            } else if ($("[name=type1]").val() == '26') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 1300000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                }
            } else if ($("[name=type1]").val() == '0.5') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 195000;
                } else if ($("[name=area]").val() == '경북' || $("[name=area]").val() == '충남') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '강원' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.002)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type1]").val() == '0.6') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 195000;
                } else if ($("[name=area]").val() == '강원' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                } else if ($("[name=area]").val() == '충북') {
                    num3 = 0;
                }
            } else if ($("[name=type1]").val() == '2.4') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 195000;
                } else if ($("[name=area]").val() == '강원' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종' || $("[name=area]").val() == '충북') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                }
            } else if ($("[name=type1]").val() == '4.5') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 390000;
                } else if ($("[name=area]").val() == '강원' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종' || $("[name=area]").val() == '충북') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                }
            } else if ($("[name=type1]").val() == '4.6') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 650000;
                } else if ($("[name=area]").val() == '강원' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종' || $("[name=area]").val() == '충북') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남' || $("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.0015)) * 10;
                }
            }
        } else if ($("[name=purpose]:checked").val() == 'category2') {
            if ($("[name=type2]").val() == '1000') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = Math.floor((num0 * 10000 * 0.003)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.002)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type2]").val() == 'SUV') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = Math.floor((num0 * 10000 * 0.002)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종' || $("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    alert("대전,울산,경기,강원,전북,전남,경북,충남,충북,제주,인천,경남 지역의\n다목적 차량은 배기량 기준으로 책정됩니다.\n배기량을 선택해 주세요.");
                    $(".tablearea2").css("display", "none");
                    return false;
                }
            } else if ($("[name=type2]").val() == '7') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 130000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종' || $("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    alert("대전,울산,경기,강원,전북,전남,경북,충남,충북,제주,인천,경남 지역의\n다목적 차량은 배기량 기준으로 책정됩니다.\n배기량을 선택해 주세요.");
                    $(".tablearea2").css("display", "none");
                    return false;
                }
            } else if ($("[name=type2]").val() == '11') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 130000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type2]").val() == '16') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 215000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type2]").val() == '26') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 435000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type2]").val() == '0.5') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 65000;
                } else if ($("[name=area]").val() == '강원' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.0005)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                } else if ($("[name=area]").val() == '제주') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                }
            } else if ($("[name=type2]").val() == '0.6') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 65000;
                } else if ($("[name=area]").val() == '강원' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type2]").val() == '2.4') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 65000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type2]").val() == '4.5') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 130000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            } else if ($("[name=type2]").val() == '4.6') {
                if ($("[name=area]").val() == '서울' || $("[name=area]").val() == '부산' || $("[name=area]").val() == '대구') {
                    num3 = 215000;
                } else if ($("[name=area]").val() == '충북' || $("[name=area]").val() == '광주' || $("[name=area]").val() == '강원' || $("[name=area]").val() == '경기' || $("[name=area]").val() == '대전' || $("[name=area]").val() == '울산' || $("[name=area]").val() == '전북' || $("[name=area]").val() == '전남' || $("[name=area]").val() == '경북' || $("[name=area]").val() == '제주' || $("[name=area]").val() == '충남' || $("[name=area]").val() == '세종') {
                    num3 = Math.floor((num0 * 10000 * 0.001)) * 10;
                } else if ($("[name=area]").val() == '인천' || $("[name=area]").val() == '경남') {
                    num3 = 0;
                }
            }
        } else {
            num3 = 0;
        }

        //등록세 계산
        if ($("[name=purpose]:checked").val() == 'category1') {

            num4 = 1000;//증지대
            if ($("[name=type1]").val() == '999') {
                num1 = 0;
                num6 = 0;
            } else if ($("[name=area]").val() == '제주' && ($("[name=type1]").val() != '999' && $("[name=type1]").val() != '1499' && $("[name=type1]").val() != '1599' && $("[name=type1]").val() != '1999' && $("[name=type1]").val() != '2000')) {
                num1 = Math.floor((num0 * 10000 * 0.002)) * 10;
                num6 = 2;
            } else if ($("[name=type1]").val() != '999' && $("[name=type1]").val() != '1499' && $("[name=type1]").val() != '1599' && $("[name=type1]").val() != '1999' && $("[name=type1]").val() != '2000' && $("[name=type1]").val() != '7') {
                num1 = Math.floor((num0 * 10000 * 0.003)) * 10;
                num6 = 3;
            } else if ($("[name=area]").val() == '제주') {
                num1 = Math.floor((num0 * 10000 * 0.003)) * 10;
                num6 = 3;
            } else {
                num1 = Math.floor((num0 * 10000 * 0.005)) * 10;
                num6 = 5;
            }
            //취득세
            if ($("[name=type1]").val() == '999') {
                num2 = 0;
                num7 = 0;
            } else {
                num2 = Math.floor((num0 * 10000 * 0.002)) * 10;
                num7 = 2;
            }
        } else if ($("[name=purpose]:checked").val() == 'category2') {
            num4 = 1000;//증지대
            num1 = Math.floor((num0 * 10000 * 0.002)) * 10;
            num6 = 2;
            num2 = Math.floor((num0 * 10000 * 0.002)) * 10;
            num7 = 2;
        }

        //알선수수료 계산
        if ($("[name=type1]").val() == '999') {
            num8 = 400000;
        } else {
            num8 = Math.floor((stripComma(salePrice) * 10000 * 0.022));
        }

        num5 = 3000;
        $("#num1").html(nformat(num1 + num2));
        $("#num3").html(nformat(num3));
        $("#num3_1").html(nformat(num3 * 0.05));
        $("#num4").html(nformat(num4));
        $("#num5").html(nformat(num5));
        $("#num6").html(nformat(num1 + num2 + num3 + num4 + num5));
        $("#num6_1").html(nformat(num1 + num2 + (num3 * 0.05) + num4 + num5));
        $("#dealer").html(nformat(num8));
        $("#sellfee").html(nformat(num9));
        $("#num7").html(nformat(num1 + num2 + (num3 * 0.05) + num4 + num5 + (num0 * 10000) + num8 + num9));
    }

    function checkNum(value, isDec) {
        var RegExp;
        if (!isDec) isDec = false;
        RegExp = (isDec) ? /^-?[\d\.]*$/ : /^-?[\d]*$/;
        return RegExp.test(value) ? true : false;
    }

    function change_menu() {
        if ($("[name=purpose]:checked").val() == "category1") {
            $("#category1").css("display", "");
            $("#category2").css("display", "none");
            $(".tablearea2").css("display", "none");
        } else if ($("[name=purpose]:checked").val() == "category2") {
            $("#category1").css("display", "none");
            $("#category2").css("display", "");
            $(".tablearea2").css("display", "none");
        }
    }

    $(document).ready(function () {
        change_menu();
        $("[name=purpose]").change(function () {
            change_menu();
        });
    });

    // URL 복사
    function urlClip() {
        navigator.clipboard.writeText(window.location.href);
        $popup.alert("URL이 복사되었습니다."); // 알림창
    }

    // facebook 공유- 원본
    function facebookClip() {
        // 현재 URL
        const url = window.location.href;

        window.open("http://www.facebook.com/sharer/sharer.php?u=" + url, "", "width=486,height=286");
    }

    // kakao 공유
    function kakaoClip() {
        let productName1 = /*[[${productDetail.makerName}]]*/'';
        let productName2 = /*[[${productDetail.modelName}]]*/'';
        let productName3 = /*[[${productDetail.detailGradeName}]]*/'';
        let file = /*[[${productDetail.carImageUrl}]]*/ '';

        // 초기화 여러번 수행 방지
        if (!Kakao.isInitialized()) {
            Kakao.init('dec046fdf6940aac4ef595bd30977201');
            console.log('Kakao Initialized');
        }


        const url = window.location.href;

        Kakao.Share.sendDefault({
            objectType: 'feed',
            content: {
                title: productName1 + ' ' + productName2 + ' ' + productName3 + ' 차량 정보를 확인하세요!',
                imageUrl: file[0].realUrl,
                link: {
                    mobileWebUrl: url,
                    webUrl: url,
                }
            }
        });
    }

    var ht = new Happytalk({
        siteId: '1000228194',
        siteName: '카통령',
        categoryId: '129884',
        divisionId: '129885'
    });

    function chatting() {
        const dt = new Date().toLocaleString();
        alert('버튼클릭일시: ' + dt);
        ht.open();
    }

    // 제품 이미지 슬라이드
    var vehiclePaging = new Swiper(".sliderPaging .swiper-container", {
        spaceBetween: 12,
        slidesPerView: 4,
        watchSlidesProgress: true,
        navigation: {
            nextEl: '.vehicle-img .sliderPaging .swiper-navi .swiper-next',
            prevEl: '.vehicle-img .sliderPaging .swiper-navi .swiper-prev',
        },
    });

    var vehicleMain = new Swiper(".sliderMain .swiper-container", {
        // spaceBetween: 10,
        autoplay: {
            delay: 3000,
            disableOnInteraction: false,
        },
        loop: true,
        thumbs: {
            swiper: vehiclePaging,
        },
        on: {
            afterInit: function () {
                document.querySelectorAll('.sliderMain').forEach(function (imgwrap) {
                    console.log(imgwrap);
                    const viewer = new Viewer(imgwrap, {});
                });
            }
        },
        navigation: {
            nextEl: '.vehicle-img .sliderMain .swiper-navi .swiper-next',
            prevEl: '.vehicle-img .sliderMain .swiper-navi .swiper-prev',
        },
        breakpoints: {
            1130: {
                loop: false,
            },
        }
    });

    const saleSlide = new Swiper('.sale-wrap .sale-slide .swiper', {
        slidesPerView: 1.4,
        speed: 800,
        spaceBetween: 20,
        slidesOffsetAfter: 16,
        autoplay: {
            delay: 3000,
            disableOnInteraction: false,
        },
        pagination: {
            el: ".sale-wrap .sale-slide .pagination",
            type: "progressbar"
        },
        navigation: {
            nextEl: '.sale-wrap .sale-slide .swiper-navi .next',
            prevEl: '.sale-wrap .sale-slide .swiper-navi .prev',
        },
        breakpoints: {
            // 768: {
            //   slidesPerView: 3,
            // },
            1024: {
                slidesPerView: 4,
                spaceBetween: 18,
                slidesOffsetAfter: 0,
            }
        }
    });

    const saleContainer = document.querySelector('.sale-wrap .sale-slide');

    saleContainer.addEventListener('mouseenter', () => {
        saleSlide.autoplay.stop();
    });

    saleContainer.addEventListener('mouseleave', () => {
        saleSlide.autoplay.start();
    });

    // 슬라이더 끝

    async function getPickCount(productId) {
        try {
            const response = await fetch(`/api/product/getPickCountOfProduct/${productId}`);
            return await response.json(); // 서버에서 받은 데이터 반환
        } catch (error) {
            console.error('Error:', error);
            return null; // 에러 발생 시 빈 배열 반환
        }
    }

    async function updatePickCount(productId) {
        try {
            let count = await getPickCount(productId);

            if (count !== null) {
                let pickCountElement = document.getElementById('viewPickCount');
                if (pickCountElement) {

                    // 0.5초 후에 카운트 증가 및 업데이트
                    setTimeout(() => {

                        pickCountElement.textContent = count;
                    }, 500);
                } else {
                    console.error("pickCount null 입니다");
                }
            }
        } catch (error) {
            console.error("픽 카운트 가져오다 에러발생:", error);
        }
    }

    // 좋아요 누르면 픽에 추가됨
    document.querySelectorAll(".pick_check").forEach(tag => {
        tag.addEventListener("click", function () {
            let productId = tag.getAttribute("productId");
            let originalChecked = tag.checked;

            fetch("/api/sub/pick/v2", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    productId: productId,
                })
            })
                .then(res => res.json())
                .then(result => {
                    if (result.code !== 200) {
                        tag.checked = !originalChecked;

                        if (!originalChecked) {
                            tag.nextElementSibling.style.backgroundImage = "url('../user/images/common/ico/view_like_on.svg')";
                        } else {
                            tag.nextElementSibling.style.backgroundImage = "url('../user/images/common/ico/view_like.svg')";
                        }
                        $popup.alert(result.message, {
                            modal: true,
                            confirm: () => {
                                location.href = "/login";
                            }
                        })
                    } else {
                        updatePickCount(productId);
                    }
                })
        })
    })
</script>
</html>
