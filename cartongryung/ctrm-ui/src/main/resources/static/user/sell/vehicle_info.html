<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="format-detection" content="telephone=no" />
	<meta name="description" content="CUV">
	<link rel="icon" href="../images/favicon/favicon_48x48.svg" sizes="48x48">
	<link rel="icon" href="../images/favicon/favicon_96x96.svg" sizes="96x96">
	<link rel="icon" href="../images/favicon/favicon_144x144.svg" sizes="144x144">
	<link rel="icon" href="../images/favicon/favicon_196x196.svg" sizes="196x196">
	<meta property="og:image" content="../images/favicon/ogi.png" />
	<meta property="og:image:width" content="270" />
	<meta property="og:image:height" content="270" />
	<meta property="og:title" content="" />
	<meta property="og:description" content="" />
	<title>카통령</title>
	<!-- css -->
	<link rel="stylesheet" href="../css/general.css">
	<link rel="stylesheet" href="../css/swiper-bundle.min.css">
	<!-- js -->
	<script src="../js/jquery-1.12.4.min.js"></script>
	<script src="../js/jquery-ui.js"></script>
	<script src="../js/layout.js"></script>
	<script src="../js/swiper-bundle.min.js"></script>
	<script src="../js/wbz-popup.v1.js"></script>
	<script src="../js/datepicker-ko.js"></script>
</head>

<body>
	<!-- 본문 바로가기 -->
	<div id="skipNav"><a href="#contents" onclick="document.getElementById('contents').tabIndex = -1;document.getElementById('contents').focus();return false;">본문 바로가기</a></div>
	<div id="container">
		<div class="js-include" data-include="../outline/header_sub.html" data-event="header"></div>
		<div class="js-include" data-include="../outline/aside.html" data-event="aside"></div>

		<main id="contents">
			<div class="sub-content">
				<div class="sell-wrap">
					<div class="member-wrap">
						<div class="w-set">
							<div class="tit-area">
								<h2 class="tit hide-m">내 차 팔기</h2>
							</div>
							<div class="step-wrap">
								<ul class="step-list">
									<li class="on">
										<i class="i-step01"></i>
										<span class="txt">차량정보</span>
									</li>
									<li class="step-arrow on">다음단계</li>
									<li>
										<i class="i-step02"></i>
										<span class="txt">사진업로드</span>
									</li>
									<li class="step-arrow">다음단계</li>
									<li>
										<i class="i-step03"></i>
										<span class="txt">약관동의</span>
									</li>
									<li class="step-arrow">다음단계</li>
									<li>
										<i class="i-step04"></i>
										<span class="txt">신청완료</span>
									</li>
								</ul>
							</div>
							<div class="car-res-pop">
								<div class="car-res-messenger" id="typing-container">
									<div class="message-wrap">
										<div class="car-no-box ani-event">
											<p>123<span class="ko">가</span>1234</p>
										</div>
									</div>
									<div class="message-wrap">
										<div class="message-box ani-event">
											<p><span class="fc-po">올 뉴 MKZ 차량</span>을 확인했어요.</p>
										</div>
									</div>
									<div class="message-wrap">
										<div class="message-box ani-event">
											<p>차량 최초 등록일은 <span class="fc-po">yyyy.mm.dd</span> 7년차 이네요.</p>
										</div>
									</div>
									<div class="message-wrap">
										<div class="message-box ani-event">
											<p>예상 주행거리 <span class="fc-po">70,000km-80,000km</span></p>
										</div>
										<div class="message-box ani-event">
											<p>주행거리가 <span class="fc-po">70,000km</span> 라면 점검이 필요합니다.</p>
										</div>
									</div>
									<div class="message-wrap">
										<div class="message-box ani-event">
											<p>타이어 사이즈는 <span class="fc-po">245/40R19</span> <u>1년에 한 번 이상은</u> 타이어 마모도를 꼭 확인해보세요.</p>
											<p class="sub-t">타이어를 바꾼 적이 있다면 사이즈가 다를 수 있습니다.</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>
       
		<div class="js-include" data-include="../outline/footer_sub.html" data-event="footer"></div>

		<!-- 차량정보 확인 팝업 -->
		<div class="wbz-popup-cont is-template" id="vehiclePopup">
			<div class="popup-header">
				<button type="button" class="popup-close" onclick="$popup.close();">✕</button>
			</div>
			<div class="popup-cont">
				<div class="vehicle-wrap">
					<p class="txt">등록된 <span>123가 1234</span> 차량 정보를<br>확인해 주세요.</p>
					<div class="vehicle-box">기아 K5 하이브리드</div>
					<div class="popup-button">
						<button type="button" class="cr_2 popup-close">취소</button>
						<button type="button" class="cr_1 popup-confirm-event">맞습니다</button>
					</div>
				</div>
			</div>
		</div>
		<!-- //차량정보 확인 팝업 -->
	</div>

	<script>
		//서브 페이지 제목
		var hdNm = "내 차 팔기";

		// 20230714 타이핑 효과
		function splitStringByTags(inputString) {
			let resultArray = [];
			
			while (inputString.length > 0) {
				let startIndex = inputString.indexOf("<");
				let endIndex = inputString.indexOf(">");
				
				if (startIndex === -1 || endIndex === -1) {
					// console.log(1);
					// console.log(inputString);
					for (let char of inputString) {
						resultArray.push(char);
					}
					// resultArray.push(inputString); // 태그가 없는 텍스트 저장
					break; // 태그가 없을 경우 종료
				}
				
				if (startIndex > 0) {
					// console.log(2);
					let text = inputString.substring(0, startIndex);
					// console.log(text);
					for (let char of text) {
						resultArray.push(char);
					}
					// resultArray.push(text); // 태그로 감싸져 있지 않은 텍스트 저장
				}
				
				let tag = inputString.substring(startIndex, endIndex + 1);
				resultArray.push(tag); // 태그 저장
				
				inputString = inputString.substring(endIndex + 1);
			}
			return resultArray;
		}

		function wait(ms) {
			return new Promise(res => setTimeout(res, ms))
		}

		const textAni = async (selector) => {
			// 타이핑 속도 간격
			let speed = 60;
			let searchPattern = /</;
			let searchPattern2 = /<\/+/;

			// 텍스트 정보 저장 후 빈값 만들기
			let input = selector.querySelector('p').innerHTML;
			let tagsArray = splitStringByTags(input);
			selector.querySelector('p').innerHTML = '';
			// 박스 보이기
			selector.classList.add('show');
			// 타이핑 효과 실행
			let isInner = false;
			let isInnerTag = '';
			let isSkip = false;
			while (tagsArray.length) {
				await wait(speed);
				if (tagsArray.length == 0) {
				} else if (searchPattern2.test(tagsArray[0])) {
					isInner = false;
					isSkip = true;
					isInnerTag = '';
				} else if (searchPattern.test(tagsArray[0])) {
					if (/span/.test(tagsArray[0])) {
						isInnerTag = 'span';
					} else if (/u/.test(tagsArray[0])) {
						isInnerTag = 'u';
					}
				}

				if (isSkip) {
					isSkip = false;
				} else if (isInner && isInnerTag != '') {
					selector.querySelector('p').querySelector(isInnerTag).innerHTML += tagsArray[0];
				} else {
					if (isInnerTag != '') {
						isInner = true;
					} else {
						isInner = false;
					}
					selector.querySelector('p').innerHTML += tagsArray[0];
				}
				tagsArray.shift();
			}
		};

		document.addEventListener("DOMContentLoaded", () => {
			// 말풍선 애니메이션 간격
			let aniSec = 1000;
			let messegeWraps = document.querySelectorAll('.message-wrap');
			let mwCount = 0;

			const messegeWrapLoop = async () => {
				let loopParent = messegeWraps[mwCount];
				if (!loopParent) {
					return false;
				}
				let boxMessage = loopParent.querySelectorAll('.message-box');
				loopParent.classList.add('show');
				if (boxMessage.length > 0) {
					for (let i=0; i<boxMessage.length;i++) {
						await textAni(boxMessage[i]);
					}
					setTimeout(messegeWrapLoop, aniSec);
				} else if (loopParent.querySelector('.car-no-box')) {
					loopParent.querySelector('.car-no-box').classList.add('show');
					setTimeout(messegeWrapLoop, aniSec);
				}
				mwCount++;
			}
			// 최초 실행
			setTimeout(messegeWrapLoop, 1000);
			
		});

		// 20230714 타이핑 효과 end
	</script>
</body>
</html>